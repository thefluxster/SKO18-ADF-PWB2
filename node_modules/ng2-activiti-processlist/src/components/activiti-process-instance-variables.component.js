/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("@angular/core");
var ng2_alfresco_core_1 = require("ng2-alfresco-core");
var ng2_alfresco_datatable_1 = require("ng2-alfresco-datatable");
var process_instance_variable_model_1 = require("./../models/process-instance-variable.model");
var activiti_process_service_1 = require("./../services/activiti-process.service");
var ActivitiProcessInstanceVariables = (function () {
    function ActivitiProcessInstanceVariables(translate, activitiProcess) {
        this.translate = translate;
        this.activitiProcess = activitiProcess;
        this.error = new core_1.EventEmitter();
        this.defaultSchemaColumn = [
            { type: 'text', key: 'name', title: 'Name', cssClass: 'full-width name-column', sortable: true },
            { type: 'text', key: 'value', title: 'Value', sortable: true },
            { type: 'text', key: 'scope', title: 'Scope', sortable: true }
        ];
        if (translate) {
            translate.addTranslationFolder('ng2-activiti-processlist', 'node_modules/ng2-activiti-processlist/src');
        }
    }
    ActivitiProcessInstanceVariables.prototype.ngOnInit = function () {
        if (!this.data) {
            this.data = this.initDefaultSchemaColumns();
        }
        if (this.processInstanceId) {
            this.getProcessInstanceVariables(this.processInstanceId);
            return;
        }
    };
    ActivitiProcessInstanceVariables.prototype.ngOnChanges = function (changes) {
        var processInstanceId = changes['processInstanceId'];
        if (processInstanceId) {
            if (processInstanceId.currentValue) {
                this.getProcessInstanceVariables(processInstanceId.currentValue);
            }
            else {
                this.resetVariables();
            }
        }
    };
    ActivitiProcessInstanceVariables.prototype.isListEmpty = function () {
        return this.data === undefined ||
            (this.data && this.data.getRows() && this.data.getRows().length === 0);
    };
    ActivitiProcessInstanceVariables.prototype.initDefaultSchemaColumns = function () {
        return new ng2_alfresco_datatable_1.ObjectDataTableAdapter([], this.defaultSchemaColumn);
    };
    ActivitiProcessInstanceVariables.prototype.createDataRow = function (instances) {
        var instancesRows = [];
        instances.forEach(function (row) {
            instancesRows.push(new ng2_alfresco_datatable_1.ObjectDataRow({
                name: row.name,
                value: row.value,
                scope: row.scope
            }));
        });
        return instancesRows;
    };
    ActivitiProcessInstanceVariables.prototype.renderInstances = function (instances) {
        this.data.setRows(instances);
    };
    ActivitiProcessInstanceVariables.prototype.getProcessInstanceVariables = function (processInstanceId) {
        var _this = this;
        if (processInstanceId) {
            this.activitiProcess.getProcessInstanceVariables(processInstanceId).subscribe(function (res) {
                var instancesRow = _this.createDataRow(res);
                _this.renderInstances(instancesRow);
            }, function (err) {
                _this.error.emit(err);
            });
        }
        else {
            this.resetVariables();
        }
    };
    ActivitiProcessInstanceVariables.prototype.resetVariables = function () {
        if (this.data) {
            this.data.setRows([]);
        }
    };
    ActivitiProcessInstanceVariables.prototype.polyfillDialog = function (dialog) {
        if (!dialog.nativeElement.showModal) {
            dialogPolyfill.registerDialog(dialog.nativeElement);
        }
    };
    ActivitiProcessInstanceVariables.prototype.showAddDialog = function () {
        this.resetForm();
        this.polyfillDialog(this.addDialog);
        this.addDialog.nativeElement.showModal();
    };
    ActivitiProcessInstanceVariables.prototype.showEditDialog = function (row) {
        this.variableName = row.getValue('name');
        this.variableValue = row.getValue('value');
        this.variableScope = row.getValue('scope');
        this.polyfillDialog(this.editDialog);
        this.editDialog.nativeElement.showModal();
    };
    ActivitiProcessInstanceVariables.prototype.showErrorDialog = function () {
        this.polyfillDialog(this.errorDialog);
        this.errorDialog.nativeElement.showModal();
    };
    ActivitiProcessInstanceVariables.prototype.add = function () {
        var _this = this;
        this.activitiProcess.createOrUpdateProcessInstanceVariables(this.processInstanceId, [new process_instance_variable_model_1.ProcessInstanceVariable({
                name: this.variableName,
                value: this.variableValue,
                scope: this.variableScope
            })]).subscribe(function (res) {
            _this.getProcessInstanceVariables(_this.processInstanceId);
            _this.resetForm();
        }, function (err) {
            _this.showErrorDialog();
            _this.error.emit(err);
        });
        this.closeAddDialog();
    };
    ActivitiProcessInstanceVariables.prototype.edit = function () {
        var _this = this;
        this.activitiProcess.createOrUpdateProcessInstanceVariables(this.processInstanceId, [new process_instance_variable_model_1.ProcessInstanceVariable({
                name: this.variableName,
                value: this.variableValue,
                scope: this.variableScope
            })]).subscribe(function (res) {
            _this.getProcessInstanceVariables(_this.processInstanceId);
            _this.resetForm();
        }, function (err) {
            _this.showErrorDialog();
            _this.error.emit(err);
        });
        this.closeEditDialog();
    };
    ActivitiProcessInstanceVariables.prototype.closeAddDialog = function () {
        this.addDialog.nativeElement.close();
    };
    ActivitiProcessInstanceVariables.prototype.closeEditDialog = function () {
        this.editDialog.nativeElement.close();
    };
    ActivitiProcessInstanceVariables.prototype.closeErrorDialog = function () {
        this.errorDialog.nativeElement.close();
    };
    ActivitiProcessInstanceVariables.prototype.resetForm = function () {
        this.variableName = '';
        this.variableValue = '';
        this.variableScope = 'global';
    };
    ActivitiProcessInstanceVariables.prototype.onDeleteVariable = function (row) {
        var _this = this;
        this.activitiProcess.deleteProcessInstanceVariable(this.processInstanceId, row.getValue('name')).subscribe(function () {
            _this.getProcessInstanceVariables(_this.processInstanceId);
        }, function (err) {
            _this.showErrorDialog();
            _this.error.emit(err);
        });
    };
    ActivitiProcessInstanceVariables.prototype.onExecuteRowAction = function (event) {
        var row = event.args.row;
        var action = event.args.action;
        if (action && action.id === 'delete') {
            this.onDeleteVariable(row);
        }
        if (action && action.id === 'edit') {
            this.showEditDialog(row);
        }
    };
    ActivitiProcessInstanceVariables.prototype.onShowRowActionsMenu = function (event) {
        event.args.actions = [{
                id: 'delete',
                title: 'Delete'
            }, {
                id: 'edit',
                title: 'Edit'
            }];
    };
    return ActivitiProcessInstanceVariables;
}());
__decorate([
    core_1.Input(),
    __metadata("design:type", String)
], ActivitiProcessInstanceVariables.prototype, "processInstanceId", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object)
], ActivitiProcessInstanceVariables.prototype, "data", void 0);
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], ActivitiProcessInstanceVariables.prototype, "error", void 0);
__decorate([
    core_1.ViewChild('addDialog'),
    __metadata("design:type", core_1.DebugElement)
], ActivitiProcessInstanceVariables.prototype, "addDialog", void 0);
__decorate([
    core_1.ViewChild('editDialog'),
    __metadata("design:type", core_1.DebugElement)
], ActivitiProcessInstanceVariables.prototype, "editDialog", void 0);
__decorate([
    core_1.ViewChild('errorDialog'),
    __metadata("design:type", core_1.DebugElement)
], ActivitiProcessInstanceVariables.prototype, "errorDialog", void 0);
ActivitiProcessInstanceVariables = __decorate([
    core_1.Component({
        selector: 'activiti-process-instance-variables',
        moduleId: module.id,
        template: "<div id=\"setVariableBtn\" (click)=\"showAddDialog()\" class=\"icon material-icons\">add</div> <div class=\"mdl-tooltip\" for=\"setVariableBtn\">     {{ 'DETAILS.VARIABLES.BUTTON.ADD' |translate }} </div>   <div *ngIf=\"!isListEmpty()\">     <alfresco-datatable [data]=\"data\" [actions]=\"true\" (showRowActionsMenu)=\"onShowRowActionsMenu($event)\"                         (executeRowAction)=\"onExecuteRowAction($event)\"></alfresco-datatable> </div> <div *ngIf=\"isListEmpty()\" data-automation-id=\"variables-none\">     {{ 'DETAILS.VARIABLES.NONE' | translate }} </div>   <dialog class=\"mdl-dialog add-dialog\" #addDialog>     <h4 class=\"mdl-dialog__title\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.TITLE' |translate }}</h4>     <div class=\"mdl-dialog__content\">         <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">             <label class=\"mdl-textfield__label\" for=\"addVariableName\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.LABEL.NAME' |translate }}</label>             <input class=\"mdl-textfield__input\" type=\"text\" [(ngModel)]=\"variableName\" id=\"addVariableName\" [readonly]=\"editMode\" />         </div>         <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">             <label class=\"mdl-textfield__label\" for=\"addVariableValue\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.LABEL.VALUE' |translate }}</label>             <input class=\"mdl-textfield__input\" type=\"text\" [(ngModel)]=\"variableValue\" id=\"addVariableValue\" />         </div>     </div>     <div class=\"mdl-dialog__actions\">         <button type=\"button\" (click)=\"add()\" class=\"mdl-button\">{{ 'DETAILS.VARIABLES.DIALOG.BUTTON.SET' |translate }}</button>         <button type=\"button\" (click)=\"closeAddDialog()\" class=\"mdl-button close\">{{ 'DETAILS.VARIABLES.DIALOG.BUTTON.CANCEL' |translate }}</button>     </div> </dialog>   <dialog class=\"mdl-dialog edit-dialog\" #editDialog>     <h4 class=\"mdl-dialog__title\">{{ 'DETAILS.VARIABLES.EDIT_DIALOG.TITLE' |translate }}</h4>     <div class=\"mdl-dialog__content\">         <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">             <label class=\"mdl-textfield__label\" for=\"editVariableName\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.LABEL.NAME' |translate }}</label>             <input class=\"mdl-textfield__input\" type=\"text\" [(ngModel)]=\"variableName\" id=\"editVariableName\" [readonly]=\"true\" />         </div>         <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">             <label class=\"mdl-textfield__label\" for=\"editVariableValue\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.LABEL.VALUE' |translate }}</label>             <input class=\"mdl-textfield__input\" type=\"text\" [(ngModel)]=\"variableValue\" id=\"editVariableValue\" />         </div>         <div class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label\">             <label class=\"mdl-textfield__label\" for=\"editVariableScope\">{{ 'DETAILS.VARIABLES.ADD_DIALOG.LABEL.SCOPE' |translate }}</label>             <input class=\"mdl-textfield__input\" type=\"text\" [(ngModel)]=\"variableName\" id=\"editVariableScope\" [readonly]=\"true\" />         </div>     </div>     <div class=\"mdl-dialog__actions\">         <button type=\"button\" (click)=\"edit()\" class=\"mdl-button\">{{ 'DETAILS.VARIABLES.DIALOG.BUTTON.SET' |translate }}</button>         <button type=\"button\" (click)=\"closeEditDialog()\" class=\"mdl-button close\">{{ 'DETAILS.VARIABLES.DIALOG.BUTTON.CANCEL' |translate }}</button>     </div> </dialog>   <dialog class=\"mdl-dialog error-dialog\" #errorDialog>     <h4 class=\"mdl-dialog__title\">{{ 'DETAILS.VARIABLES.ERROR_DIALOG.TITLE' |translate }}</h4>     <div class=\"mdl-dialog__content\">         <p>{{ 'DETAILS.VARIABLES.ERROR_DIALOG.DESCRIPTION' |translate }}</p>     </div>     <div class=\"mdl-dialog__actions\">         <button type=\"button\" (click)=\"closeErrorDialog()\" class=\"mdl-button close\">{{ 'DETAILS.VARIABLES.DIALOG.BUTTON.OK' |translate }}</button>     </div> </dialog>",
        styles: [""],
        providers: [activiti_process_service_1.ActivitiProcessService]
    }),
    __metadata("design:paramtypes", [ng2_alfresco_core_1.AlfrescoTranslationService,
        activiti_process_service_1.ActivitiProcessService])
], ActivitiProcessInstanceVariables);
exports.ActivitiProcessInstanceVariables = ActivitiProcessInstanceVariables;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvYWN0aXZpdGktcHJvY2Vzcy1pbnN0YW5jZS12YXJpYWJsZXMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7Ozs7Ozs7Ozs7QUFFSCxzQ0FBa0k7QUFFbEksdURBQStEO0FBQy9ELGlFQUFpRztBQUNqRywrRkFBc0Y7QUFDdEYsbUZBQWdGO0FBWWhGLElBQWEsZ0NBQWdDO0lBbUN6QywwQ0FBb0IsU0FBcUMsRUFDckMsZUFBdUM7UUFEdkMsY0FBUyxHQUFULFNBQVMsQ0FBNEI7UUFDckMsb0JBQWUsR0FBZixlQUFlLENBQXdCO1FBM0IzRCxVQUFLLEdBQXNCLElBQUksbUJBQVksRUFBTyxDQUFDO1FBVzNDLHdCQUFtQixHQUFVO1lBQ2pDLEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLHdCQUF3QixFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUM7WUFDOUYsRUFBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFDO1lBQzVELEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBQztTQUMvRCxDQUFDO1FBY0UsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNaLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQywwQkFBMEIsRUFBRSwyQ0FBMkMsQ0FBQyxDQUFDO1FBQzVHLENBQUM7SUFFTCxDQUFDO0lBRUQsbURBQVEsR0FBUjtRQUNJLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDYixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyx3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YWN0aXZpdGktcHJvY2Vzcy1pbnN0YW5jZS12YXJpYWJsZXMuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTYgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQ29tcG9uZW50LCBEZWJ1Z0VsZW1lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE91dHB1dCwgT25Jbml0LCBWaWV3Q2hpbGQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBBbGZyZXNjb1RyYW5zbGF0aW9uU2VydmljZSB9IGZyb20gJ25nMi1hbGZyZXNjby1jb3JlJztcbmltcG9ydCB7IE9iamVjdERhdGFUYWJsZUFkYXB0ZXIsIERhdGFUYWJsZUFkYXB0ZXIsIE9iamVjdERhdGFSb3cgfSBmcm9tICduZzItYWxmcmVzY28tZGF0YXRhYmxlJztcbmltcG9ydCB7IFByb2Nlc3NJbnN0YW5jZVZhcmlhYmxlIH0gZnJvbSAnLi8uLi9tb2RlbHMvcHJvY2Vzcy1pbnN0YW5jZS12YXJpYWJsZS5tb2RlbCc7XG5pbXBvcnQgeyBBY3Rpdml0aVByb2Nlc3NTZXJ2aWNlIH0gZnJvbSAnLi8uLi9zZXJ2aWNlcy9hY3Rpdml0aS1wcm9jZXNzLnNlcnZpY2UnO1xuXG5kZWNsYXJlIGxldCBjb21wb25lbnRIYW5kbGVyOiBhbnk7XG5kZWNsYXJlIGxldCBkaWFsb2dQb2x5ZmlsbDogYW55O1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FjdGl2aXRpLXByb2Nlc3MtaW5zdGFuY2UtdmFyaWFibGVzJyxcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHRlbXBsYXRlOiBcIjxkaXYgaWQ9XFxcInNldFZhcmlhYmxlQnRuXFxcIiAoY2xpY2spPVxcXCJzaG93QWRkRGlhbG9nKClcXFwiIGNsYXNzPVxcXCJpY29uIG1hdGVyaWFsLWljb25zXFxcIj5hZGQ8L2Rpdj4gPGRpdiBjbGFzcz1cXFwibWRsLXRvb2x0aXBcXFwiIGZvcj1cXFwic2V0VmFyaWFibGVCdG5cXFwiPiAgICAge3sgJ0RFVEFJTFMuVkFSSUFCTEVTLkJVVFRPTi5BREQnIHx0cmFuc2xhdGUgfX0gPC9kaXY+ICAgPGRpdiAqbmdJZj1cXFwiIWlzTGlzdEVtcHR5KClcXFwiPiAgICAgPGFsZnJlc2NvLWRhdGF0YWJsZSBbZGF0YV09XFxcImRhdGFcXFwiIFthY3Rpb25zXT1cXFwidHJ1ZVxcXCIgKHNob3dSb3dBY3Rpb25zTWVudSk9XFxcIm9uU2hvd1Jvd0FjdGlvbnNNZW51KCRldmVudClcXFwiICAgICAgICAgICAgICAgICAgICAgICAgIChleGVjdXRlUm93QWN0aW9uKT1cXFwib25FeGVjdXRlUm93QWN0aW9uKCRldmVudClcXFwiPjwvYWxmcmVzY28tZGF0YXRhYmxlPiA8L2Rpdj4gPGRpdiAqbmdJZj1cXFwiaXNMaXN0RW1wdHkoKVxcXCIgZGF0YS1hdXRvbWF0aW9uLWlkPVxcXCJ2YXJpYWJsZXMtbm9uZVxcXCI+ICAgICB7eyAnREVUQUlMUy5WQVJJQUJMRVMuTk9ORScgfCB0cmFuc2xhdGUgfX0gPC9kaXY+ICAgPGRpYWxvZyBjbGFzcz1cXFwibWRsLWRpYWxvZyBhZGQtZGlhbG9nXFxcIiAjYWRkRGlhbG9nPiAgICAgPGg0IGNsYXNzPVxcXCJtZGwtZGlhbG9nX190aXRsZVxcXCI+e3sgJ0RFVEFJTFMuVkFSSUFCTEVTLkFERF9ESUFMT0cuVElUTEUnIHx0cmFuc2xhdGUgfX08L2g0PiAgICAgPGRpdiBjbGFzcz1cXFwibWRsLWRpYWxvZ19fY29udGVudFxcXCI+ICAgICAgICAgPGRpdiBjbGFzcz1cXFwibWRsLXRleHRmaWVsZCBtZGwtanMtdGV4dGZpZWxkIG1kbC10ZXh0ZmllbGQtLWZsb2F0aW5nLWxhYmVsXFxcIj4gICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVxcXCJtZGwtdGV4dGZpZWxkX19sYWJlbFxcXCIgZm9yPVxcXCJhZGRWYXJpYWJsZU5hbWVcXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5BRERfRElBTE9HLkxBQkVMLk5BTUUnIHx0cmFuc2xhdGUgfX08L2xhYmVsPiAgICAgICAgICAgICA8aW5wdXQgY2xhc3M9XFxcIm1kbC10ZXh0ZmllbGRfX2lucHV0XFxcIiB0eXBlPVxcXCJ0ZXh0XFxcIiBbKG5nTW9kZWwpXT1cXFwidmFyaWFibGVOYW1lXFxcIiBpZD1cXFwiYWRkVmFyaWFibGVOYW1lXFxcIiBbcmVhZG9ubHldPVxcXCJlZGl0TW9kZVxcXCIgLz4gICAgICAgICA8L2Rpdj4gICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtZGwtdGV4dGZpZWxkIG1kbC1qcy10ZXh0ZmllbGQgbWRsLXRleHRmaWVsZC0tZmxvYXRpbmctbGFiZWxcXFwiPiAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9XFxcIm1kbC10ZXh0ZmllbGRfX2xhYmVsXFxcIiBmb3I9XFxcImFkZFZhcmlhYmxlVmFsdWVcXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5BRERfRElBTE9HLkxBQkVMLlZBTFVFJyB8dHJhbnNsYXRlIH19PC9sYWJlbD4gICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJtZGwtdGV4dGZpZWxkX19pbnB1dFxcXCIgdHlwZT1cXFwidGV4dFxcXCIgWyhuZ01vZGVsKV09XFxcInZhcmlhYmxlVmFsdWVcXFwiIGlkPVxcXCJhZGRWYXJpYWJsZVZhbHVlXFxcIiAvPiAgICAgICAgIDwvZGl2PiAgICAgPC9kaXY+ICAgICA8ZGl2IGNsYXNzPVxcXCJtZGwtZGlhbG9nX19hY3Rpb25zXFxcIj4gICAgICAgICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgKGNsaWNrKT1cXFwiYWRkKClcXFwiIGNsYXNzPVxcXCJtZGwtYnV0dG9uXFxcIj57eyAnREVUQUlMUy5WQVJJQUJMRVMuRElBTE9HLkJVVFRPTi5TRVQnIHx0cmFuc2xhdGUgfX08L2J1dHRvbj4gICAgICAgICA8YnV0dG9uIHR5cGU9XFxcImJ1dHRvblxcXCIgKGNsaWNrKT1cXFwiY2xvc2VBZGREaWFsb2coKVxcXCIgY2xhc3M9XFxcIm1kbC1idXR0b24gY2xvc2VcXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5ESUFMT0cuQlVUVE9OLkNBTkNFTCcgfHRyYW5zbGF0ZSB9fTwvYnV0dG9uPiAgICAgPC9kaXY+IDwvZGlhbG9nPiAgIDxkaWFsb2cgY2xhc3M9XFxcIm1kbC1kaWFsb2cgZWRpdC1kaWFsb2dcXFwiICNlZGl0RGlhbG9nPiAgICAgPGg0IGNsYXNzPVxcXCJtZGwtZGlhbG9nX190aXRsZVxcXCI+e3sgJ0RFVEFJTFMuVkFSSUFCTEVTLkVESVRfRElBTE9HLlRJVExFJyB8dHJhbnNsYXRlIH19PC9oND4gICAgIDxkaXYgY2xhc3M9XFxcIm1kbC1kaWFsb2dfX2NvbnRlbnRcXFwiPiAgICAgICAgIDxkaXYgY2xhc3M9XFxcIm1kbC10ZXh0ZmllbGQgbWRsLWpzLXRleHRmaWVsZCBtZGwtdGV4dGZpZWxkLS1mbG9hdGluZy1sYWJlbFxcXCI+ICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cXFwibWRsLXRleHRmaWVsZF9fbGFiZWxcXFwiIGZvcj1cXFwiZWRpdFZhcmlhYmxlTmFtZVxcXCI+e3sgJ0RFVEFJTFMuVkFSSUFCTEVTLkFERF9ESUFMT0cuTEFCRUwuTkFNRScgfHRyYW5zbGF0ZSB9fTwvbGFiZWw+ICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwibWRsLXRleHRmaWVsZF9faW5wdXRcXFwiIHR5cGU9XFxcInRleHRcXFwiIFsobmdNb2RlbCldPVxcXCJ2YXJpYWJsZU5hbWVcXFwiIGlkPVxcXCJlZGl0VmFyaWFibGVOYW1lXFxcIiBbcmVhZG9ubHldPVxcXCJ0cnVlXFxcIiAvPiAgICAgICAgIDwvZGl2PiAgICAgICAgIDxkaXYgY2xhc3M9XFxcIm1kbC10ZXh0ZmllbGQgbWRsLWpzLXRleHRmaWVsZCBtZGwtdGV4dGZpZWxkLS1mbG9hdGluZy1sYWJlbFxcXCI+ICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz1cXFwibWRsLXRleHRmaWVsZF9fbGFiZWxcXFwiIGZvcj1cXFwiZWRpdFZhcmlhYmxlVmFsdWVcXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5BRERfRElBTE9HLkxBQkVMLlZBTFVFJyB8dHJhbnNsYXRlIH19PC9sYWJlbD4gICAgICAgICAgICAgPGlucHV0IGNsYXNzPVxcXCJtZGwtdGV4dGZpZWxkX19pbnB1dFxcXCIgdHlwZT1cXFwidGV4dFxcXCIgWyhuZ01vZGVsKV09XFxcInZhcmlhYmxlVmFsdWVcXFwiIGlkPVxcXCJlZGl0VmFyaWFibGVWYWx1ZVxcXCIgLz4gICAgICAgICA8L2Rpdj4gICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtZGwtdGV4dGZpZWxkIG1kbC1qcy10ZXh0ZmllbGQgbWRsLXRleHRmaWVsZC0tZmxvYXRpbmctbGFiZWxcXFwiPiAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9XFxcIm1kbC10ZXh0ZmllbGRfX2xhYmVsXFxcIiBmb3I9XFxcImVkaXRWYXJpYWJsZVNjb3BlXFxcIj57eyAnREVUQUlMUy5WQVJJQUJMRVMuQUREX0RJQUxPRy5MQUJFTC5TQ09QRScgfHRyYW5zbGF0ZSB9fTwvbGFiZWw+ICAgICAgICAgICAgIDxpbnB1dCBjbGFzcz1cXFwibWRsLXRleHRmaWVsZF9faW5wdXRcXFwiIHR5cGU9XFxcInRleHRcXFwiIFsobmdNb2RlbCldPVxcXCJ2YXJpYWJsZU5hbWVcXFwiIGlkPVxcXCJlZGl0VmFyaWFibGVTY29wZVxcXCIgW3JlYWRvbmx5XT1cXFwidHJ1ZVxcXCIgLz4gICAgICAgICA8L2Rpdj4gICAgIDwvZGl2PiAgICAgPGRpdiBjbGFzcz1cXFwibWRsLWRpYWxvZ19fYWN0aW9uc1xcXCI+ICAgICAgICAgPGJ1dHRvbiB0eXBlPVxcXCJidXR0b25cXFwiIChjbGljayk9XFxcImVkaXQoKVxcXCIgY2xhc3M9XFxcIm1kbC1idXR0b25cXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5ESUFMT0cuQlVUVE9OLlNFVCcgfHRyYW5zbGF0ZSB9fTwvYnV0dG9uPiAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiAoY2xpY2spPVxcXCJjbG9zZUVkaXREaWFsb2coKVxcXCIgY2xhc3M9XFxcIm1kbC1idXR0b24gY2xvc2VcXFwiPnt7ICdERVRBSUxTLlZBUklBQkxFUy5ESUFMT0cuQlVUVE9OLkNBTkNFTCcgfHRyYW5zbGF0ZSB9fTwvYnV0dG9uPiAgICAgPC9kaXY+IDwvZGlhbG9nPiAgIDxkaWFsb2cgY2xhc3M9XFxcIm1kbC1kaWFsb2cgZXJyb3ItZGlhbG9nXFxcIiAjZXJyb3JEaWFsb2c+ICAgICA8aDQgY2xhc3M9XFxcIm1kbC1kaWFsb2dfX3RpdGxlXFxcIj57eyAnREVUQUlMUy5WQVJJQUJMRVMuRVJST1JfRElBTE9HLlRJVExFJyB8dHJhbnNsYXRlIH19PC9oND4gICAgIDxkaXYgY2xhc3M9XFxcIm1kbC1kaWFsb2dfX2NvbnRlbnRcXFwiPiAgICAgICAgIDxwPnt7ICdERVRBSUxTLlZBUklBQkxFUy5FUlJPUl9ESUFMT0cuREVTQ1JJUFRJT04nIHx0cmFuc2xhdGUgfX08L3A+ICAgICA8L2Rpdj4gICAgIDxkaXYgY2xhc3M9XFxcIm1kbC1kaWFsb2dfX2FjdGlvbnNcXFwiPiAgICAgICAgIDxidXR0b24gdHlwZT1cXFwiYnV0dG9uXFxcIiAoY2xpY2spPVxcXCJjbG9zZUVycm9yRGlhbG9nKClcXFwiIGNsYXNzPVxcXCJtZGwtYnV0dG9uIGNsb3NlXFxcIj57eyAnREVUQUlMUy5WQVJJQUJMRVMuRElBTE9HLkJVVFRPTi5PSycgfHRyYW5zbGF0ZSB9fTwvYnV0dG9uPiAgICAgPC9kaXY+IDwvZGlhbG9nPlwiLFxuICAgIHN0eWxlczogW1wiXCJdLFxuICAgIHByb3ZpZGVyczogW0FjdGl2aXRpUHJvY2Vzc1NlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIEFjdGl2aXRpUHJvY2Vzc0luc3RhbmNlVmFyaWFibGVzIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMge1xuXG4gICAgQElucHV0KClcbiAgICBwcm9jZXNzSW5zdGFuY2VJZDogc3RyaW5nO1xuXG4gICAgQElucHV0KClcbiAgICBkYXRhOiBEYXRhVGFibGVBZGFwdGVyO1xuXG4gICAgQE91dHB1dCgpXG4gICAgZXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBAVmlld0NoaWxkKCdhZGREaWFsb2cnKVxuICAgIGFkZERpYWxvZzogRGVidWdFbGVtZW50O1xuXG4gICAgQFZpZXdDaGlsZCgnZWRpdERpYWxvZycpXG4gICAgZWRpdERpYWxvZzogRGVidWdFbGVtZW50O1xuXG4gICAgQFZpZXdDaGlsZCgnZXJyb3JEaWFsb2cnKVxuICAgIGVycm9yRGlhbG9nOiBEZWJ1Z0VsZW1lbnQ7XG5cbiAgICBwcml2YXRlIGRlZmF1bHRTY2hlbWFDb2x1bW46IGFueVtdID0gW1xuICAgICAgICB7dHlwZTogJ3RleHQnLCBrZXk6ICduYW1lJywgdGl0bGU6ICdOYW1lJywgY3NzQ2xhc3M6ICdmdWxsLXdpZHRoIG5hbWUtY29sdW1uJywgc29ydGFibGU6IHRydWV9LFxuICAgICAgICB7dHlwZTogJ3RleHQnLCBrZXk6ICd2YWx1ZScsIHRpdGxlOiAnVmFsdWUnLCBzb3J0YWJsZTogdHJ1ZX0sXG4gICAgICAgIHt0eXBlOiAndGV4dCcsIGtleTogJ3Njb3BlJywgdGl0bGU6ICdTY29wZScsIHNvcnRhYmxlOiB0cnVlfVxuICAgIF07XG5cbiAgICB2YXJpYWJsZU5hbWU6IHN0cmluZztcbiAgICB2YXJpYWJsZVZhbHVlOiBzdHJpbmc7XG4gICAgdmFyaWFibGVTY29wZTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0gdHJhbnNsYXRlIFRyYW5zbGF0aW9uIHNlcnZpY2VcbiAgICAgKiBAcGFyYW0gYWN0aXZpdGlQcm9jZXNzIFByb2Nlc3Mgc2VydmljZVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHJhbnNsYXRlOiBBbGZyZXNjb1RyYW5zbGF0aW9uU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGFjdGl2aXRpUHJvY2VzczogQWN0aXZpdGlQcm9jZXNzU2VydmljZSkge1xuXG4gICAgICAgIGlmICh0cmFuc2xhdGUpIHtcbiAgICAgICAgICAgIHRyYW5zbGF0ZS5hZGRUcmFuc2xhdGlvbkZvbGRlcignbmcyLWFjdGl2aXRpLXByb2Nlc3NsaXN0JywgJ25vZGVfbW9kdWxlcy9uZzItYWN0aXZpdGktcHJvY2Vzc2xpc3Qvc3JjJyk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICBpZiAoIXRoaXMuZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5pbml0RGVmYXVsdFNjaGVtYUNvbHVtbnMoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzSW5zdGFuY2VJZCkge1xuICAgICAgICAgICAgdGhpcy5nZXRQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZXModGhpcy5wcm9jZXNzSW5zdGFuY2VJZCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgIGxldCBwcm9jZXNzSW5zdGFuY2VJZCA9IGNoYW5nZXNbJ3Byb2Nlc3NJbnN0YW5jZUlkJ107XG4gICAgICAgIGlmIChwcm9jZXNzSW5zdGFuY2VJZCkge1xuICAgICAgICAgICAgaWYgKHByb2Nlc3NJbnN0YW5jZUlkLmN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UHJvY2Vzc0luc3RhbmNlVmFyaWFibGVzKHByb2Nlc3NJbnN0YW5jZUlkLmN1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRWYXJpYWJsZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHRoZSBsaXN0IGlzIGVtcHR5XG4gICAgICogQHJldHVybnMge09iamVjdERhdGFUYWJsZUFkYXB0ZXJ8Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc0xpc3RFbXB0eSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAodGhpcy5kYXRhICYmIHRoaXMuZGF0YS5nZXRSb3dzKCkgJiYgdGhpcy5kYXRhLmdldFJvd3MoKS5sZW5ndGggPT09IDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBpbml0RGVmYXVsdFNjaGVtYUNvbHVtbnMgaW5zdGFuY2Ugd2l0aCB0aGUgZGVmYXVsdCBTY2hlbWEgQ29sdW1uXG4gICAgICogQHJldHVybnMge09iamVjdERhdGFUYWJsZUFkYXB0ZXJ9XG4gICAgICovXG4gICAgcHJpdmF0ZSBpbml0RGVmYXVsdFNjaGVtYUNvbHVtbnMoKTogT2JqZWN0RGF0YVRhYmxlQWRhcHRlciB7XG4gICAgICAgIHJldHVybiBuZXcgT2JqZWN0RGF0YVRhYmxlQWRhcHRlcihcbiAgICAgICAgICAgIFtdLFxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0U2NoZW1hQ29sdW1uXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGFuIGFycmF5IG9mIE9iamVjdERhdGFSb3dcbiAgICAgKiBAcGFyYW0gaW5zdGFuY2VzXG4gICAgICogQHJldHVybnMge09iamVjdERhdGFSb3dbXX1cbiAgICAgKi9cbiAgICBwcml2YXRlIGNyZWF0ZURhdGFSb3coaW5zdGFuY2VzOiBQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZVtdKTogT2JqZWN0RGF0YVJvd1tdIHtcbiAgICAgICAgbGV0IGluc3RhbmNlc1Jvd3M6IE9iamVjdERhdGFSb3dbXSA9IFtdO1xuICAgICAgICBpbnN0YW5jZXMuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgICAgICAgICBpbnN0YW5jZXNSb3dzLnB1c2gobmV3IE9iamVjdERhdGFSb3coe1xuICAgICAgICAgICAgICAgIG5hbWU6IHJvdy5uYW1lLFxuICAgICAgICAgICAgICAgIHZhbHVlOiByb3cudmFsdWUsXG4gICAgICAgICAgICAgICAgc2NvcGU6IHJvdy5zY29wZVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGluc3RhbmNlc1Jvd3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBpbnN0YW5jZXMgbGlzdFxuICAgICAqXG4gICAgICogQHBhcmFtIGluc3RhbmNlc1xuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVySW5zdGFuY2VzKGluc3RhbmNlczogYW55W10pIHtcbiAgICAgICAgdGhpcy5kYXRhLnNldFJvd3MoaW5zdGFuY2VzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFByb2Nlc3NJbnN0YW5jZVZhcmlhYmxlcyhwcm9jZXNzSW5zdGFuY2VJZDogc3RyaW5nKSB7XG4gICAgICAgIGlmIChwcm9jZXNzSW5zdGFuY2VJZCkge1xuICAgICAgICAgICAgdGhpcy5hY3Rpdml0aVByb2Nlc3MuZ2V0UHJvY2Vzc0luc3RhbmNlVmFyaWFibGVzKHByb2Nlc3NJbnN0YW5jZUlkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgKHJlczogUHJvY2Vzc0luc3RhbmNlVmFyaWFibGVbXSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaW5zdGFuY2VzUm93ID0gdGhpcy5jcmVhdGVEYXRhUm93KHJlcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySW5zdGFuY2VzKGluc3RhbmNlc1Jvdyk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAoZXJyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IuZW1pdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0VmFyaWFibGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHJlc2V0VmFyaWFibGVzKCkge1xuICAgICAgICBpZiAodGhpcy5kYXRhKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEuc2V0Um93cyhbXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHBvbHlmaWxsRGlhbG9nKGRpYWxvZzogRGVidWdFbGVtZW50KSB7XG4gICAgICAgIGlmICghZGlhbG9nLm5hdGl2ZUVsZW1lbnQuc2hvd01vZGFsKSB7XG4gICAgICAgICAgICBkaWFsb2dQb2x5ZmlsbC5yZWdpc3RlckRpYWxvZyhkaWFsb2cubmF0aXZlRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc2hvd0FkZERpYWxvZygpIHtcbiAgICAgICAgdGhpcy5yZXNldEZvcm0oKTtcbiAgICAgICAgdGhpcy5wb2x5ZmlsbERpYWxvZyh0aGlzLmFkZERpYWxvZyk7XG4gICAgICAgIHRoaXMuYWRkRGlhbG9nLm5hdGl2ZUVsZW1lbnQuc2hvd01vZGFsKCk7XG4gICAgfVxuXG4gICAgcHVibGljIHNob3dFZGl0RGlhbG9nKHJvdzogT2JqZWN0RGF0YVJvdykge1xuICAgICAgICB0aGlzLnZhcmlhYmxlTmFtZSA9IHJvdy5nZXRWYWx1ZSgnbmFtZScpO1xuICAgICAgICB0aGlzLnZhcmlhYmxlVmFsdWUgPSByb3cuZ2V0VmFsdWUoJ3ZhbHVlJyk7XG4gICAgICAgIHRoaXMudmFyaWFibGVTY29wZSA9IHJvdy5nZXRWYWx1ZSgnc2NvcGUnKTtcbiAgICAgICAgdGhpcy5wb2x5ZmlsbERpYWxvZyh0aGlzLmVkaXREaWFsb2cpO1xuICAgICAgICB0aGlzLmVkaXREaWFsb2cubmF0aXZlRWxlbWVudC5zaG93TW9kYWwoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2hvd0Vycm9yRGlhbG9nKCkge1xuICAgICAgICB0aGlzLnBvbHlmaWxsRGlhbG9nKHRoaXMuZXJyb3JEaWFsb2cpO1xuICAgICAgICB0aGlzLmVycm9yRGlhbG9nLm5hdGl2ZUVsZW1lbnQuc2hvd01vZGFsKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZCgpIHtcbiAgICAgICAgdGhpcy5hY3Rpdml0aVByb2Nlc3MuY3JlYXRlT3JVcGRhdGVQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZXModGhpcy5wcm9jZXNzSW5zdGFuY2VJZCwgW25ldyBQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZSh7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLnZhcmlhYmxlTmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhcmlhYmxlVmFsdWUsXG4gICAgICAgICAgICBzY29wZTogdGhpcy52YXJpYWJsZVNjb3BlXG4gICAgICAgIH0pXSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlczogUHJvY2Vzc0luc3RhbmNlVmFyaWFibGVbXSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UHJvY2Vzc0luc3RhbmNlVmFyaWFibGVzKHRoaXMucHJvY2Vzc0luc3RhbmNlSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGb3JtKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yRGlhbG9nKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY2xvc2VBZGREaWFsb2coKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZWRpdCgpIHtcbiAgICAgICAgdGhpcy5hY3Rpdml0aVByb2Nlc3MuY3JlYXRlT3JVcGRhdGVQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZXModGhpcy5wcm9jZXNzSW5zdGFuY2VJZCwgW25ldyBQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZSh7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLnZhcmlhYmxlTmFtZSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhcmlhYmxlVmFsdWUsXG4gICAgICAgICAgICBzY29wZTogdGhpcy52YXJpYWJsZVNjb3BlXG4gICAgICAgIH0pXSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlczogUHJvY2Vzc0luc3RhbmNlVmFyaWFibGVbXSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0UHJvY2Vzc0luc3RhbmNlVmFyaWFibGVzKHRoaXMucHJvY2Vzc0luc3RhbmNlSWQpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGb3JtKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yRGlhbG9nKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvci5lbWl0KGVycik7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuY2xvc2VFZGl0RGlhbG9nKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsb3NlQWRkRGlhbG9nKCkge1xuICAgICAgICB0aGlzLmFkZERpYWxvZy5uYXRpdmVFbGVtZW50LmNsb3NlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNsb3NlRWRpdERpYWxvZygpIHtcbiAgICAgICAgdGhpcy5lZGl0RGlhbG9nLm5hdGl2ZUVsZW1lbnQuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2xvc2VFcnJvckRpYWxvZygpIHtcbiAgICAgICAgdGhpcy5lcnJvckRpYWxvZy5uYXRpdmVFbGVtZW50LmNsb3NlKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNldEZvcm0oKSB7XG4gICAgICAgIHRoaXMudmFyaWFibGVOYW1lID0gJyc7XG4gICAgICAgIHRoaXMudmFyaWFibGVWYWx1ZSA9ICcnO1xuICAgICAgICB0aGlzLnZhcmlhYmxlU2NvcGUgPSAnZ2xvYmFsJztcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRGVsZXRlVmFyaWFibGUocm93OiBPYmplY3REYXRhUm93KSB7XG4gICAgICAgIHRoaXMuYWN0aXZpdGlQcm9jZXNzLmRlbGV0ZVByb2Nlc3NJbnN0YW5jZVZhcmlhYmxlKHRoaXMucHJvY2Vzc0luc3RhbmNlSWQsIHJvdy5nZXRWYWx1ZSgnbmFtZScpKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5nZXRQcm9jZXNzSW5zdGFuY2VWYXJpYWJsZXModGhpcy5wcm9jZXNzSW5zdGFuY2VJZCk7XG4gICAgICAgIH0sXG4gICAgICAgIChlcnIpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yRGlhbG9nKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9yLmVtaXQoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25FeGVjdXRlUm93QWN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGxldCByb3c6IE9iamVjdERhdGFSb3cgPSBldmVudC5hcmdzLnJvdztcbiAgICAgICAgbGV0IGFjdGlvbiA9IGV2ZW50LmFyZ3MuYWN0aW9uO1xuICAgICAgICBpZiAoYWN0aW9uICYmIGFjdGlvbi5pZCA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgIHRoaXMub25EZWxldGVWYXJpYWJsZShyb3cpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb24gJiYgYWN0aW9uLmlkID09PSAnZWRpdCcpIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0VkaXREaWFsb2cocm93KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uU2hvd1Jvd0FjdGlvbnNNZW51KGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LmFyZ3MuYWN0aW9ucyA9IFt7XG4gICAgICAgICAgICBpZDogJ2RlbGV0ZScsXG4gICAgICAgICAgICB0aXRsZTogJ0RlbGV0ZSdcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgaWQ6ICdlZGl0JyxcbiAgICAgICAgICAgIHRpdGxlOiAnRWRpdCdcbiAgICAgICAgfV07XG4gICAgfVxufVxuIl19
