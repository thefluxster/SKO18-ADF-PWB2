/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("@angular/core");
var ng2_alfresco_core_1 = require("ng2-alfresco-core");
var rendering_queue_services_1 = require("../services/rendering-queue.services");
var PdfViewerComponent = (function () {
    function PdfViewerComponent(renderingQueueServices, logService) {
        this.renderingQueueServices = renderingQueueServices;
        this.logService = logService;
        this.showToolbar = true;
        this.currentScaleMode = 'auto';
        this.MAX_AUTO_SCALE = 1.25;
        this.DEFAULT_SCALE_DELTA = 1.1;
        this.MIN_SCALE = 0.25;
        this.MAX_SCALE = 10.0;
    }
    PdfViewerComponent.prototype.ngOnChanges = function (changes) {
        var _this = this;
        if (!this.urlFile) {
            throw new Error('Attribute urlFile is required');
        }
        if (this.urlFile) {
            return new Promise(function (resolve, reject) {
                var loadingTask = _this.getPDFJS().getDocument(_this.urlFile);
                loadingTask.onProgress = function (progressData) {
                    var level = progressData.loaded / progressData.total;
                    _this.laodingPercent = Math.round(level * 100);
                };
                loadingTask.then(function (pdfDocument) {
                    _this.currentPdfDocument = pdfDocument;
                    _this.totalPages = pdfDocument.numPages;
                    _this.page = 1;
                    _this.displayPage = 1;
                    _this.initPDFViewer(_this.currentPdfDocument);
                    _this.currentPdfDocument.getPage(1).then(function () {
                        _this.scalePage('auto');
                        resolve();
                    }, function (error) {
                        reject(error);
                    });
                }, function (error) {
                    reject(error);
                });
            });
        }
    };
    PdfViewerComponent.prototype.getPDFJS = function () {
        return PDFJS;
    };
    PdfViewerComponent.prototype.initPDFViewer = function (pdfDocument) {
        var _this = this;
        PDFJS.verbosity = 1;
        PDFJS.disableWorker = false;
        var documentContainer = document.getElementById('viewer-pdf-container');
        var viewer = document.getElementById('viewer-viewerPdf');
        window.document.addEventListener('scroll', function (event) {
            _this.watchScroll(event.target);
        }, true);
        this.pdfViewer = new PDFJS.PDFViewer({
            container: documentContainer,
            viewer: viewer,
            renderingQueue: this.renderingQueueServices
        });
        this.renderingQueueServices.setViewer(this.pdfViewer);
        this.pdfViewer.setDocument(pdfDocument);
    };
    PdfViewerComponent.prototype.scalePage = function (scaleMode) {
        this.currentScaleMode = scaleMode;
        if (this.pdfViewer) {
            var viewerContainer = document.getElementById('viewer-main-container');
            var documentContainer = document.getElementById('viewer-pdf-container');
            var widthContainer = void 0;
            var heigthContainer = void 0;
            if (viewerContainer && viewerContainer.clientWidth <= documentContainer.clientWidth) {
                widthContainer = viewerContainer.clientWidth;
                heigthContainer = viewerContainer.clientHeight;
            }
            else {
                widthContainer = documentContainer.clientWidth;
                heigthContainer = documentContainer.clientHeight;
            }
            var currentPage = this.pdfViewer._pages[this.pdfViewer._currentPageNumber];
            var padding = 20;
            var pageWidthScale = (widthContainer - padding) / currentPage.width * currentPage.scale;
            var pageHeightScale = (heigthContainer - padding) / currentPage.width * currentPage.scale;
            var scale = void 0;
            switch (this.currentScaleMode) {
                case 'page-actual':
                    scale = 1;
                    break;
                case 'page-width':
                    scale = pageWidthScale;
                    break;
                case 'page-height':
                    scale = pageHeightScale;
                    break;
                case 'page-fit':
                    scale = Math.min(pageWidthScale, pageHeightScale);
                    break;
                case 'auto':
                    var horizontalScale = void 0;
                    if (this.isLandscape) {
                        horizontalScale = Math.min(pageHeightScale, pageWidthScale);
                    }
                    else {
                        horizontalScale = pageWidthScale;
                    }
                    scale = Math.min(this.MAX_AUTO_SCALE, horizontalScale);
                    break;
                default:
                    this.logService.error('pdfViewSetScale: \'' + scaleMode + '\' is an unknown zoom value.');
                    return;
            }
            this.setScaleUpdatePages(scale);
        }
    };
    PdfViewerComponent.prototype.setScaleUpdatePages = function (newScale) {
        if (!this.isSameScale(this.currentScale, newScale)) {
            this.currentScale = newScale;
            this.pdfViewer._pages.forEach(function (currentPage) {
                currentPage.update(newScale);
            });
            this.pdfViewer.update();
        }
    };
    PdfViewerComponent.prototype.isSameScale = function (oldScale, newScale) {
        return (newScale === oldScale);
    };
    PdfViewerComponent.prototype.isLandscape = function (width, height) {
        return (width > height);
    };
    PdfViewerComponent.prototype.onResize = function () {
        this.scalePage(this.currentScaleMode);
    };
    PdfViewerComponent.prototype.pageFit = function () {
        if (this.currentScaleMode !== 'page-fit') {
            this.scalePage('page-fit');
        }
        else {
            this.scalePage('auto');
        }
    };
    PdfViewerComponent.prototype.zoomIn = function (ticks) {
        var newScale = this.currentScale;
        do {
            newScale = (newScale * this.DEFAULT_SCALE_DELTA).toFixed(2);
            newScale = Math.ceil(newScale * 10) / 10;
            newScale = Math.min(this.MAX_SCALE, newScale);
        } while (--ticks > 0 && newScale < this.MAX_SCALE);
        this.currentScaleMode = 'auto';
        this.setScaleUpdatePages(newScale);
    };
    PdfViewerComponent.prototype.zoomOut = function (ticks) {
        var newScale = this.currentScale;
        do {
            newScale = (newScale / this.DEFAULT_SCALE_DELTA).toFixed(2);
            newScale = Math.floor(newScale * 10) / 10;
            newScale = Math.max(this.MIN_SCALE, newScale);
        } while (--ticks > 0 && newScale > this.MIN_SCALE);
        this.currentScaleMode = 'auto';
        this.setScaleUpdatePages(newScale);
    };
    PdfViewerComponent.prototype.previousPage = function () {
        if (this.pdfViewer && this.page > 1) {
            this.page--;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
    };
    PdfViewerComponent.prototype.nextPage = function () {
        if (this.pdfViewer && this.page < this.totalPages) {
            this.page++;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
    };
    PdfViewerComponent.prototype.inputPage = function (page) {
        var pageInput = parseInt(page, 10);
        if (!isNaN(pageInput) && pageInput > 0 && pageInput <= this.totalPages) {
            this.page = pageInput;
            this.displayPage = this.page;
            this.pdfViewer.currentPageNumber = this.page;
        }
        else {
            this.displayPage = this.page;
        }
    };
    PdfViewerComponent.prototype.watchScroll = function (target) {
        var outputPage = this.getVisibleElement(target);
        if (outputPage) {
            this.page = outputPage.id;
            this.displayPage = this.page;
        }
    };
    PdfViewerComponent.prototype.getVisibleElement = function (target) {
        var _this = this;
        return this.pdfViewer._pages.find(function (page) {
            return _this.isOnScreen(page, target);
        });
    };
    PdfViewerComponent.prototype.isOnScreen = function (page, target) {
        var viewport = {};
        viewport.top = target.scrollTop;
        viewport.bottom = viewport.top + target.scrollHeight;
        var bounds = {};
        bounds.top = page.div.offsetTop;
        bounds.bottom = bounds.top + page.viewport.height;
        return ((bounds.top <= viewport.bottom) && (bounds.bottom >= viewport.top));
    };
    ;
    PdfViewerComponent.prototype.handleKeyboardEvent = function (event) {
        var key = event.keyCode;
        if (key === 39) {
            this.nextPage();
        }
        else if (key === 37) {
            this.previousPage();
        }
    };
    return PdfViewerComponent;
}());
__decorate([
    core_1.Input(),
    __metadata("design:type", String)
], PdfViewerComponent.prototype, "urlFile", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", String)
], PdfViewerComponent.prototype, "nameFile", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean)
], PdfViewerComponent.prototype, "showToolbar", void 0);
__decorate([
    core_1.HostListener('document:keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [KeyboardEvent]),
    __metadata("design:returntype", void 0)
], PdfViewerComponent.prototype, "handleKeyboardEvent", null);
PdfViewerComponent = __decorate([
    core_1.Component({
        moduleId: module.id,
        selector: 'pdf-viewer',
        template: "<!-- Start Pdf Canvas --> <div id=\"viewer-pdf-container\" class=\"viewer-pdf-container\" (keypress)=eventHandler() (window:resize)=\"onResize($event)\">     <div id=\"viewer-viewerPdf\" class=\"pdfViewer\">         <div id=\"loader-container\" class=\"loader-container\">             <div class=\"loader-item\">                 <div id=\"loader-spin\" class=\"mdl-progress mdl-js-progress mdl-progress__indeterminate\"></div>                 <div id=\"loader-text\" class=\"loader-text\">Loading <span>{{nameFile}}</span> {{laodingPercent}}%</div>             </div >         </div>     </div> </div> <!-- End Pdf Canvas -->   <!-- Pagination toolbar start --> <div *ngIf=\"showToolbar\" id=\"viewer-toolbar-pagination\" class=\"viewer-toolbar-pagination mdl-cell--hide-tablet mdl-cell--hide-phone\">     <div id=\"viewer-previous-page-button\" class=\"button-page left\" (click)=\"previousPage()\">         <i class=\"icon material-icons\">keyboard_arrow_left</i>     </div>      <div class=\"viewer-page-counter left\" >         <input id=\"viewer-pagenumber-input\"  #page                (keyup.enter)=\"inputPage(page.value)\" class=\"viewer-pagenumber-input left\" type=\"text\" pattern=\"-?[0-9]*(\\.[0-9]+)?\" value=\"{{displayPage}}\">         <div id=\"viewer-total-pages\"  class=\"left viewer-total-pages\">/ {{totalPages}}</div>     </div>      <div id=\"viewer-next-page-button\" class=\"button-page left\"  (click)=\"nextPage()\" >         <i class=\"icon material-icons\" >keyboard_arrow_right</i>     </div> </div> <!-- Pagination toolbar end -->  <!-- Command toolbar start --> <div *ngIf=\"showToolbar\"  id=\"viewer-toolbar-command\" class=\"viewer-toolbar-command\">     <div id=\"viewer-scale-page-button\" class=\"button-page left\" (click)=\"pageFit()\">         <i class=\"icon material-icons\">zoom_out_map</i>     </div>     <div id=\"viewer-zoom-in-button\" class=\"button-page left\" (click)=\"zoomIn()\">         <i class=\"icon material-icons\">zoom_in</i>     </div>     <div id=\"viewer-zoom-out-button\" class=\"button-page left\" (click)=\"zoomOut()\">         <i class=\"icon material-icons\">zoom_out</i>     </div> </div> <!-- Command toolbar end -->",
        styles: [".loader-container {     display: -webkit-box;      /* OLD - iOS 6-, Safari 3.1-6 */     display: -moz-box;         /* OLD - Firefox 19- (buggy but mostly works) */     display: -webkit-flex;     /* NEW - Chrome */     display: flex;             /* NEW, Spec - Opera 12.1, Firefox 20+ */     -webkit-box-flex-direction: row;     -moz-box-flex-direction: row;     -webkit-flex-direction: row;     flex-direction: row;     height:100%; }  .loader-item {     margin: auto;     max-height:100px;     max-width:300px; }  .loader-text{     white-space: nowrap;     text-align: center;     position: relative;     color : #fff; }  .left {     float: left; }  .viewer-toolbar-pagination{     padding-top: 4px;     top: 80px;     right:35px;     width:auto;     position:absolute;     border-radius: 10px;     background: #3E3E3E;     color: white; }  .viewer-toolbar-command{     height: 30px;     padding-top: 4px;     top: 80px;     left:35px;     width:auto;     position:absolute;     border-radius: 10px;     background: #3E3E3E;     color: white; }  .viewer-pagenumber-input {     border: none;     display: block;     font-size: 16px;     padding: 4px 0;     background: 0 0;     text-align: right;     color: inherit;     width: 33px;     margin-right: 4px;     height: 20px; }  .viewer-total-pages {     border: medium none;     display: flex;     font-size: 16px;     padding: 4px 0px;     background: transparent none repeat scroll 0px 0px;     text-align: right;     color: inherit;     margin-right: 4px;     height: 20px;     align-items: center;     justify-content: center; }  .viewer-page-counter {     margin-right: 20px; }  .button-page {     margin-right: 4px;     height: 24px;     width: 24px;     margin-left: 4px;     cursor: pointer; }  .button-page:hover {     cursor: pointer;     background: grey;     border-radius: 24px; } :host >>> .textLayer {     position: absolute;     left: 0;     top: 0;     right: 0;     bottom: 0;     overflow: hidden;     opacity: 0.2;     line-height: 1.0; }  :host >>> .textLayer > div {     color: transparent;     position: absolute;     white-space: pre;     cursor: text;     -webkit-transform-origin: 0% 0%;     -moz-transform-origin: 0% 0%;     -o-transform-origin: 0% 0%;     -ms-transform-origin: 0% 0%;     transform-origin: 0% 0%; }  :host >>> .textLayer .highlight {     margin: -1px;     padding: 1px;      background-color: rgb(180, 0, 170);     border-radius: 4px; }  :host >>> .textLayer .highlight.begin {     border-radius: 4px 0px 0px 4px; }  :host >>> .textLayer .highlight.end {     border-radius: 0px 4px 4px 0px; }  :host >>> .textLayer .highlight.middle {     border-radius: 0px; }  :host >>> .textLayer .highlight.selected {     background-color: rgb(0, 100, 0); }  :host >>> .textLayer ::selection { background: rgb(0,0,255); } :host >>> .textLayer ::-moz-selection { background: rgb(0,0,255); }  :host >>> .textLayer .endOfContent {     display: block;     position: absolute;     left: 0px;     top: 100%;     right: 0px;     bottom: 0px;     z-index: -1;     cursor: default;     -webkit-user-select: none;     -ms-user-select: none;     -moz-user-select: none; }  :host >>> .textLayer .endOfContent.active {     top: 0px; }   :host >>> .annotationLayer section {     position: absolute; }  :host >>> .annotationLayer .linkAnnotation > a {     position: absolute;     font-size: 1em;     top: 0;     left: 0;     width: 100%;     height: 100%; }  :host >>> .annotationLayer .linkAnnotation > a /* -ms-a */  {     background: url(\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\") 0 0 repeat; }  :host >>> .annotationLayer .linkAnnotation > a:hover {     opacity: 0.2;     background: #ff0;     box-shadow: 0px 2px 10px #ff0; }  :host >>> .annotationLayer .textAnnotation img {     position: absolute;     cursor: pointer; }  :host >>> .annotationLayer .popupWrapper {     position: absolute;     width: 20em; }  :host >>> .annotationLayer .popup {     position: absolute;     z-index: 200;     max-width: 20em;     background-color: #FFFF99;     box-shadow: 0px 2px 5px #333;     border-radius: 2px;     padding: 0.6em;     margin-left: 5px;     cursor: pointer;     word-wrap: break-word; }  :host >>> .annotationLayer .popup h1 {     font-size: 1em;     border-bottom: 1px solid #000000;     padding-bottom: 0.2em; }  :host >>> .annotationLayer .popup p {     padding-top: 0.2em; }  :host >>> .annotationLayer .highlightAnnotation, .annotationLayer .underlineAnnotation, .annotationLayer .squigglyAnnotation, .annotationLayer .strikeoutAnnotation, .annotationLayer .fileAttachmentAnnotation {     cursor: pointer; }  :host >>> .pdfViewer .canvasWrapper {     overflow: hidden; }  :host >>> .pdfViewer .page {     direction: ltr;     width: 816px;     height: 1056px;     margin: 1px auto -8px auto;     position: relative;     overflow: visible;     border: 9px solid transparent;     background-clip: content-box;     background-color: white; }  :host >>> .pdfViewer.removePageBorders .page {     margin: 0px auto 10px auto;     border: none; }  :host >>> .pdfViewer .page canvas {     margin: 0;     display: block; }  :host >>> .pdfViewer .page .loadingIcon {     position: absolute;     display: block;     left: 0;     top: 0;     right: 0;     bottom: 0; }  :host >>> .loadingIcon {     width: 100px;     height: 100px;     left: 50% !important;     top: 50% !important;      margin-top: -50px;     margin-left: -50px;      font-size: 5px;     text-indent: -9999em;     border-top: 1.1em solid rgba(3,0,2, 0.2);     border-right: 1.1em solid rgba(3,0,2, 0.2);     border-bottom: 1.1em solid rgba(3,0,2, 0.2);     border-left: 1.1em solid #030002;     -webkit-transform: translateZ(0);     -ms-transform: translateZ(0);     transform: translateZ(0);     -webkit-animation: load8 1.1s infinite linear;     animation: load8 1.1s infinite linear; } :host >>> .loadingIcon, :host >>> .loadingIcon:after {     border-radius: 50%; } @-webkit-keyframes load8 {     0% {         -webkit-transform: rotate(0deg);         transform: rotate(0deg);     }     100% {         -webkit-transform: rotate(360deg);         transform: rotate(360deg);     } } @keyframes load8 {     0% {         -webkit-transform: rotate(0deg);         transform: rotate(0deg);     }     100% {         -webkit-transform: rotate(360deg);         transform: rotate(360deg);     } }  :host >>> * {     padding: 0;     margin: 0; }  :host >>> html {     height: 100%;     width: 100%;     /* Font size is needed to make the activity bar the correct size. */     font-size: 10px; }  :host >>> body {     height: 100%;     width: 100%;     background-color: #404040;     background-image: url(images/texture.png); }  :host >>> body, input, button, select {     font: message-box;     outline: none; }  :host >>> .hidden {     display: none !important; } :host >>> [hidden] {     display: none !important; }   #viewer-pdf-container {     overflow: auto;     -webkit-overflow-scrolling: touch;     position: absolute;     top: 32px;     right: 0;     bottom: 0;     left: 0;     outline: none; } html[dir='ltr'] #viewer-pdf-container {     box-shadow: inset 1px 0 0 hsla(0,0%,100%,.05); } html[dir='rtl'] #viewer-pdf-container {     box-shadow: inset -1px 0 0 hsla(0,0%,100%,.05); }"],
        providers: [rendering_queue_services_1.RenderingQueueServices]
    }),
    __metadata("design:paramtypes", [rendering_queue_services_1.RenderingQueueServices,
        ng2_alfresco_core_1.LogService])
], PdfViewerComponent);
exports.PdfViewerComponent = PdfViewerComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmV0cy9wZGZWaWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7Ozs7Ozs7Ozs7QUFFSCxzQ0FBK0Q7QUFDL0QsdURBQStDO0FBQy9DLGlGQUE4RTtBQVc5RSxJQUFhLGtCQUFrQjtJQXlCM0IsNEJBQW9CLHNCQUE4QyxFQUM5QyxVQUFzQjtRQUR0QiwyQkFBc0IsR0FBdEIsc0JBQXNCLENBQXdCO1FBQzlDLGVBQVUsR0FBVixVQUFVLENBQVk7UUFqQjFDLGdCQUFXLEdBQVksSUFBSSxDQUFDO1FBUTVCLHFCQUFnQixHQUFXLE1BQU0sQ0FBQztRQUdsQyxtQkFBYyxHQUFXLElBQUksQ0FBQztRQUM5Qix3QkFBbUIsR0FBVyxHQUFHLENBQUM7UUFDbEMsY0FBUyxHQUFXLElBQUksQ0FBQztRQUN6QixjQUFTLEdBQVcsSUFBSSxDQUFDO0lBSXpCLENBQUM7SUFFRCx3Q0FBVyxHQUFYLFVBQVksT0FBTztRQUFuQixpQkFpQ0M7UUFoQ0csRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztZQUNoQixNQUFNLElBQUksS0FBSyxDQUFDLCtCQUErQixDQUFDLENBQUM7UUFDckQsQ0FBQztRQUVELEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ2YsTUFBTSxDQUFDLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFFLE1BQU07Z0JBQy9CLElBQUksV0FBVyxHQUFHLEtBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxXQUFXLENBQUMsS0FBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUU1RCxXQUFXLENBQUMsVUFBVSxHQUFHLFVBQUMsWUFBWTtvQkFDbEMsSUFBSSxLQUFLLEdBQUcsWUFBWSxDQUFDLE1BQU0sR0FBRyxZQUFZLENBQUMsS0FBSyxDQUFDO29CQUNyRCxLQUFJLENBQUMsY0FBYyxHQUFHLElBQUks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LDhvRUFBOG9FO1FBQ3hwRSxNQUFNLEVBQUUsQ0FBQyw0bE9BQTRsTyxDQUFDO1FBQ3RtTyxTQUFTLEVBQUUsQ0FBQyxpREFBc0IsQ0FBQztLQUN0QyxDQUFDO3FDQTBCOEMsaURBQXNCO1FBQ2xDLDhCQUFVO0dBMUJqQyxrQkFBa0IsQ0E4VjlCO0FBOVZZLGdEQUFrQiIsImZpbGUiOiJjb21wb25ldHMvcGRmVmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE2IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIEhvc3RMaXN0ZW5lciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTG9nU2VydmljZSB9IGZyb20gJ25nMi1hbGZyZXNjby1jb3JlJztcbmltcG9ydCB7IFJlbmRlcmluZ1F1ZXVlU2VydmljZXMgfSBmcm9tICcuLi9zZXJ2aWNlcy9yZW5kZXJpbmctcXVldWUuc2VydmljZXMnO1xuXG5kZWNsYXJlIGxldCBQREZKUzogYW55O1xuXG5AQ29tcG9uZW50KHtcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHNlbGVjdG9yOiAncGRmLXZpZXdlcicsXG4gICAgdGVtcGxhdGU6IFwiPCEtLSBTdGFydCBQZGYgQ2FudmFzIC0tPiA8ZGl2IGlkPVxcXCJ2aWV3ZXItcGRmLWNvbnRhaW5lclxcXCIgY2xhc3M9XFxcInZpZXdlci1wZGYtY29udGFpbmVyXFxcIiAoa2V5cHJlc3MpPWV2ZW50SGFuZGxlcigpICh3aW5kb3c6cmVzaXplKT1cXFwib25SZXNpemUoJGV2ZW50KVxcXCI+ICAgICA8ZGl2IGlkPVxcXCJ2aWV3ZXItdmlld2VyUGRmXFxcIiBjbGFzcz1cXFwicGRmVmlld2VyXFxcIj4gICAgICAgICA8ZGl2IGlkPVxcXCJsb2FkZXItY29udGFpbmVyXFxcIiBjbGFzcz1cXFwibG9hZGVyLWNvbnRhaW5lclxcXCI+ICAgICAgICAgICAgIDxkaXYgY2xhc3M9XFxcImxvYWRlci1pdGVtXFxcIj4gICAgICAgICAgICAgICAgIDxkaXYgaWQ9XFxcImxvYWRlci1zcGluXFxcIiBjbGFzcz1cXFwibWRsLXByb2dyZXNzIG1kbC1qcy1wcm9ncmVzcyBtZGwtcHJvZ3Jlc3NfX2luZGV0ZXJtaW5hdGVcXFwiPjwvZGl2PiAgICAgICAgICAgICAgICAgPGRpdiBpZD1cXFwibG9hZGVyLXRleHRcXFwiIGNsYXNzPVxcXCJsb2FkZXItdGV4dFxcXCI+TG9hZGluZyA8c3Bhbj57e25hbWVGaWxlfX08L3NwYW4+IHt7bGFvZGluZ1BlcmNlbnR9fSU8L2Rpdj4gICAgICAgICAgICAgPC9kaXYgPiAgICAgICAgIDwvZGl2PiAgICAgPC9kaXY+IDwvZGl2PiA8IS0tIEVuZCBQZGYgQ2FudmFzIC0tPiAgIDwhLS0gUGFnaW5hdGlvbiB0b29sYmFyIHN0YXJ0IC0tPiA8ZGl2ICpuZ0lmPVxcXCJzaG93VG9vbGJhclxcXCIgaWQ9XFxcInZpZXdlci10b29sYmFyLXBhZ2luYXRpb25cXFwiIGNsYXNzPVxcXCJ2aWV3ZXItdG9vbGJhci1wYWdpbmF0aW9uIG1kbC1jZWxsLS1oaWRlLXRhYmxldCBtZGwtY2VsbC0taGlkZS1waG9uZVxcXCI+ICAgICA8ZGl2IGlkPVxcXCJ2aWV3ZXItcHJldmlvdXMtcGFnZS1idXR0b25cXFwiIGNsYXNzPVxcXCJidXR0b24tcGFnZSBsZWZ0XFxcIiAoY2xpY2spPVxcXCJwcmV2aW91c1BhZ2UoKVxcXCI+ICAgICAgICAgPGkgY2xhc3M9XFxcImljb24gbWF0ZXJpYWwtaWNvbnNcXFwiPmtleWJvYXJkX2Fycm93X2xlZnQ8L2k+ICAgICA8L2Rpdj4gICAgICA8ZGl2IGNsYXNzPVxcXCJ2aWV3ZXItcGFnZS1jb3VudGVyIGxlZnRcXFwiID4gICAgICAgICA8aW5wdXQgaWQ9XFxcInZpZXdlci1wYWdlbnVtYmVyLWlucHV0XFxcIiAgI3BhZ2UgICAgICAgICAgICAgICAgKGtleXVwLmVudGVyKT1cXFwiaW5wdXRQYWdlKHBhZ2UudmFsdWUpXFxcIiBjbGFzcz1cXFwidmlld2VyLXBhZ2VudW1iZXItaW5wdXQgbGVmdFxcXCIgdHlwZT1cXFwidGV4dFxcXCIgcGF0dGVybj1cXFwiLT9bMC05XSooXFxcXC5bMC05XSspP1xcXCIgdmFsdWU9XFxcInt7ZGlzcGxheVBhZ2V9fVxcXCI+ICAgICAgICAgPGRpdiBpZD1cXFwidmlld2VyLXRvdGFsLXBhZ2VzXFxcIiAgY2xhc3M9XFxcImxlZnQgdmlld2VyLXRvdGFsLXBhZ2VzXFxcIj4vIHt7dG90YWxQYWdlc319PC9kaXY+ICAgICA8L2Rpdj4gICAgICA8ZGl2IGlkPVxcXCJ2aWV3ZXItbmV4dC1wYWdlLWJ1dHRvblxcXCIgY2xhc3M9XFxcImJ1dHRvbi1wYWdlIGxlZnRcXFwiICAoY2xpY2spPVxcXCJuZXh0UGFnZSgpXFxcIiA+ICAgICAgICAgPGkgY2xhc3M9XFxcImljb24gbWF0ZXJpYWwtaWNvbnNcXFwiID5rZXlib2FyZF9hcnJvd19yaWdodDwvaT4gICAgIDwvZGl2PiA8L2Rpdj4gPCEtLSBQYWdpbmF0aW9uIHRvb2xiYXIgZW5kIC0tPiAgPCEtLSBDb21tYW5kIHRvb2xiYXIgc3RhcnQgLS0+IDxkaXYgKm5nSWY9XFxcInNob3dUb29sYmFyXFxcIiAgaWQ9XFxcInZpZXdlci10b29sYmFyLWNvbW1hbmRcXFwiIGNsYXNzPVxcXCJ2aWV3ZXItdG9vbGJhci1jb21tYW5kXFxcIj4gICAgIDxkaXYgaWQ9XFxcInZpZXdlci1zY2FsZS1wYWdlLWJ1dHRvblxcXCIgY2xhc3M9XFxcImJ1dHRvbi1wYWdlIGxlZnRcXFwiIChjbGljayk9XFxcInBhZ2VGaXQoKVxcXCI+ICAgICAgICAgPGkgY2xhc3M9XFxcImljb24gbWF0ZXJpYWwtaWNvbnNcXFwiPnpvb21fb3V0X21hcDwvaT4gICAgIDwvZGl2PiAgICAgPGRpdiBpZD1cXFwidmlld2VyLXpvb20taW4tYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnV0dG9uLXBhZ2UgbGVmdFxcXCIgKGNsaWNrKT1cXFwiem9vbUluKClcXFwiPiAgICAgICAgIDxpIGNsYXNzPVxcXCJpY29uIG1hdGVyaWFsLWljb25zXFxcIj56b29tX2luPC9pPiAgICAgPC9kaXY+ICAgICA8ZGl2IGlkPVxcXCJ2aWV3ZXItem9vbS1vdXQtYnV0dG9uXFxcIiBjbGFzcz1cXFwiYnV0dG9uLXBhZ2UgbGVmdFxcXCIgKGNsaWNrKT1cXFwiem9vbU91dCgpXFxcIj4gICAgICAgICA8aSBjbGFzcz1cXFwiaWNvbiBtYXRlcmlhbC1pY29uc1xcXCI+em9vbV9vdXQ8L2k+ICAgICA8L2Rpdj4gPC9kaXY+IDwhLS0gQ29tbWFuZCB0b29sYmFyIGVuZCAtLT5cIixcbiAgICBzdHlsZXM6IFtcIi5sb2FkZXItY29udGFpbmVyIHsgICAgIGRpc3BsYXk6IC13ZWJraXQtYm94OyAgICAgIC8qIE9MRCAtIGlPUyA2LSwgU2FmYXJpIDMuMS02ICovICAgICBkaXNwbGF5OiAtbW96LWJveDsgICAgICAgICAvKiBPTEQgLSBGaXJlZm94IDE5LSAoYnVnZ3kgYnV0IG1vc3RseSB3b3JrcykgKi8gICAgIGRpc3BsYXk6IC13ZWJraXQtZmxleDsgICAgIC8qIE5FVyAtIENocm9tZSAqLyAgICAgZGlzcGxheTogZmxleDsgICAgICAgICAgICAgLyogTkVXLCBTcGVjIC0gT3BlcmEgMTIuMSwgRmlyZWZveCAyMCsgKi8gICAgIC13ZWJraXQtYm94LWZsZXgtZGlyZWN0aW9uOiByb3c7ICAgICAtbW96LWJveC1mbGV4LWRpcmVjdGlvbjogcm93OyAgICAgLXdlYmtpdC1mbGV4LWRpcmVjdGlvbjogcm93OyAgICAgZmxleC1kaXJlY3Rpb246IHJvdzsgICAgIGhlaWdodDoxMDAlOyB9ICAubG9hZGVyLWl0ZW0geyAgICAgbWFyZ2luOiBhdXRvOyAgICAgbWF4LWhlaWdodDoxMDBweDsgICAgIG1heC13aWR0aDozMDBweDsgfSAgLmxvYWRlci10ZXh0eyAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsgICAgIHRleHQtYWxpZ246IGNlbnRlcjsgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICAgIGNvbG9yIDogI2ZmZjsgfSAgLmxlZnQgeyAgICAgZmxvYXQ6IGxlZnQ7IH0gIC52aWV3ZXItdG9vbGJhci1wYWdpbmF0aW9ueyAgICAgcGFkZGluZy10b3A6IDRweDsgICAgIHRvcDogODBweDsgICAgIHJpZ2h0OjM1cHg7ICAgICB3aWR0aDphdXRvOyAgICAgcG9zaXRpb246YWJzb2x1dGU7ICAgICBib3JkZXItcmFkaXVzOiAxMHB4OyAgICAgYmFja2dyb3VuZDogIzNFM0UzRTsgICAgIGNvbG9yOiB3aGl0ZTsgfSAgLnZpZXdlci10b29sYmFyLWNvbW1hbmR7ICAgICBoZWlnaHQ6IDMwcHg7ICAgICBwYWRkaW5nLXRvcDogNHB4OyAgICAgdG9wOiA4MHB4OyAgICAgbGVmdDozNXB4OyAgICAgd2lkdGg6YXV0bzsgICAgIHBvc2l0aW9uOmFic29sdXRlOyAgICAgYm9yZGVyLXJhZGl1czogMTBweDsgICAgIGJhY2tncm91bmQ6ICMzRTNFM0U7ICAgICBjb2xvcjogd2hpdGU7IH0gIC52aWV3ZXItcGFnZW51bWJlci1pbnB1dCB7ICAgICBib3JkZXI6IG5vbmU7ICAgICBkaXNwbGF5OiBibG9jazsgICAgIGZvbnQtc2l6ZTogMTZweDsgICAgIHBhZGRpbmc6IDRweCAwOyAgICAgYmFja2dyb3VuZDogMCAwOyAgICAgdGV4dC1hbGlnbjogcmlnaHQ7ICAgICBjb2xvcjogaW5oZXJpdDsgICAgIHdpZHRoOiAzM3B4OyAgICAgbWFyZ2luLXJpZ2h0OiA0cHg7ICAgICBoZWlnaHQ6IDIwcHg7IH0gIC52aWV3ZXItdG90YWwtcGFnZXMgeyAgICAgYm9yZGVyOiBtZWRpdW0gbm9uZTsgICAgIGRpc3BsYXk6IGZsZXg7ICAgICBmb250LXNpemU6IDE2cHg7ICAgICBwYWRkaW5nOiA0cHggMHB4OyAgICAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgbm9uZSByZXBlYXQgc2Nyb2xsIDBweCAwcHg7ICAgICB0ZXh0LWFsaWduOiByaWdodDsgICAgIGNvbG9yOiBpbmhlcml0OyAgICAgbWFyZ2luLXJpZ2h0OiA0cHg7ICAgICBoZWlnaHQ6IDIwcHg7ICAgICBhbGlnbi1pdGVtczogY2VudGVyOyAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IH0gIC52aWV3ZXItcGFnZS1jb3VudGVyIHsgICAgIG1hcmdpbi1yaWdodDogMjBweDsgfSAgLmJ1dHRvbi1wYWdlIHsgICAgIG1hcmdpbi1yaWdodDogNHB4OyAgICAgaGVpZ2h0OiAyNHB4OyAgICAgd2lkdGg6IDI0cHg7ICAgICBtYXJnaW4tbGVmdDogNHB4OyAgICAgY3Vyc29yOiBwb2ludGVyOyB9ICAuYnV0dG9uLXBhZ2U6aG92ZXIgeyAgICAgY3Vyc29yOiBwb2ludGVyOyAgICAgYmFja2dyb3VuZDogZ3JleTsgICAgIGJvcmRlci1yYWRpdXM6IDI0cHg7IH0gOmhvc3QgPj4+IC50ZXh0TGF5ZXIgeyAgICAgcG9zaXRpb246IGFic29sdXRlOyAgICAgbGVmdDogMDsgICAgIHRvcDogMDsgICAgIHJpZ2h0OiAwOyAgICAgYm90dG9tOiAwOyAgICAgb3ZlcmZsb3c6IGhpZGRlbjsgICAgIG9wYWNpdHk6IDAuMjsgICAgIGxpbmUtaGVpZ2h0OiAxLjA7IH0gIDpob3N0ID4+PiAudGV4dExheWVyID4gZGl2IHsgICAgIGNvbG9yOiB0cmFuc3BhcmVudDsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIHdoaXRlLXNwYWNlOiBwcmU7ICAgICBjdXJzb3I6IHRleHQ7ICAgICAtd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46IDAlIDAlOyAgICAgLW1vei10cmFuc2Zvcm0tb3JpZ2luOiAwJSAwJTsgICAgIC1vLXRyYW5zZm9ybS1vcmlnaW46IDAlIDAlOyAgICAgLW1zLXRyYW5zZm9ybS1vcmlnaW46IDAlIDAlOyAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCUgMCU7IH0gIDpob3N0ID4+PiAudGV4dExheWVyIC5oaWdobGlnaHQgeyAgICAgbWFyZ2luOiAtMXB4OyAgICAgcGFkZGluZzogMXB4OyAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigxODAsIDAsIDE3MCk7ICAgICBib3JkZXItcmFkaXVzOiA0cHg7IH0gIDpob3N0ID4+PiAudGV4dExheWVyIC5oaWdobGlnaHQuYmVnaW4geyAgICAgYm9yZGVyLXJhZGl1czogNHB4IDBweCAwcHggNHB4OyB9ICA6aG9zdCA+Pj4gLnRleHRMYXllciAuaGlnaGxpZ2h0LmVuZCB7ICAgICBib3JkZXItcmFkaXVzOiAwcHggNHB4IDRweCAwcHg7IH0gIDpob3N0ID4+PiAudGV4dExheWVyIC5oaWdobGlnaHQubWlkZGxlIHsgICAgIGJvcmRlci1yYWRpdXM6IDBweDsgfSAgOmhvc3QgPj4+IC50ZXh0TGF5ZXIgLmhpZ2hsaWdodC5zZWxlY3RlZCB7ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMCwgMTAwLCAwKTsgfSAgOmhvc3QgPj4+IC50ZXh0TGF5ZXIgOjpzZWxlY3Rpb24geyBiYWNrZ3JvdW5kOiByZ2IoMCwwLDI1NSk7IH0gOmhvc3QgPj4+IC50ZXh0TGF5ZXIgOjotbW96LXNlbGVjdGlvbiB7IGJhY2tncm91bmQ6IHJnYigwLDAsMjU1KTsgfSAgOmhvc3QgPj4+IC50ZXh0TGF5ZXIgLmVuZE9mQ29udGVudCB7ICAgICBkaXNwbGF5OiBibG9jazsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIGxlZnQ6IDBweDsgICAgIHRvcDogMTAwJTsgICAgIHJpZ2h0OiAwcHg7ICAgICBib3R0b206IDBweDsgICAgIHotaW5kZXg6IC0xOyAgICAgY3Vyc29yOiBkZWZhdWx0OyAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgICAgIC1tcy11c2VyLXNlbGVjdDogbm9uZTsgICAgIC1tb3otdXNlci1zZWxlY3Q6IG5vbmU7IH0gIDpob3N0ID4+PiAudGV4dExheWVyIC5lbmRPZkNvbnRlbnQuYWN0aXZlIHsgICAgIHRvcDogMHB4OyB9ICAgOmhvc3QgPj4+IC5hbm5vdGF0aW9uTGF5ZXIgc2VjdGlvbiB7ICAgICBwb3NpdGlvbjogYWJzb2x1dGU7IH0gIDpob3N0ID4+PiAuYW5ub3RhdGlvbkxheWVyIC5saW5rQW5ub3RhdGlvbiA+IGEgeyAgICAgcG9zaXRpb246IGFic29sdXRlOyAgICAgZm9udC1zaXplOiAxZW07ICAgICB0b3A6IDA7ICAgICBsZWZ0OiAwOyAgICAgd2lkdGg6IDEwMCU7ICAgICBoZWlnaHQ6IDEwMCU7IH0gIDpob3N0ID4+PiAuYW5ub3RhdGlvbkxheWVyIC5saW5rQW5ub3RhdGlvbiA+IGEgLyogLW1zLWEgKi8gIHsgICAgIGJhY2tncm91bmQ6IHVybChcXFwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFJQUFBQUFBQVAvLy95SDVCQUVBQUFBQUxBQUFBQUFCQUFFQUFBSUJSQUE3XFxcIikgMCAwIHJlcGVhdDsgfSAgOmhvc3QgPj4+IC5hbm5vdGF0aW9uTGF5ZXIgLmxpbmtBbm5vdGF0aW9uID4gYTpob3ZlciB7ICAgICBvcGFjaXR5OiAwLjI7ICAgICBiYWNrZ3JvdW5kOiAjZmYwOyAgICAgYm94LXNoYWRvdzogMHB4IDJweCAxMHB4ICNmZjA7IH0gIDpob3N0ID4+PiAuYW5ub3RhdGlvbkxheWVyIC50ZXh0QW5ub3RhdGlvbiBpbWcgeyAgICAgcG9zaXRpb246IGFic29sdXRlOyAgICAgY3Vyc29yOiBwb2ludGVyOyB9ICA6aG9zdCA+Pj4gLmFubm90YXRpb25MYXllciAucG9wdXBXcmFwcGVyIHsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIHdpZHRoOiAyMGVtOyB9ICA6aG9zdCA+Pj4gLmFubm90YXRpb25MYXllciAucG9wdXAgeyAgICAgcG9zaXRpb246IGFic29sdXRlOyAgICAgei1pbmRleDogMjAwOyAgICAgbWF4LXdpZHRoOiAyMGVtOyAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRkY5OTsgICAgIGJveC1zaGFkb3c6IDBweCAycHggNXB4ICMzMzM7ICAgICBib3JkZXItcmFkaXVzOiAycHg7ICAgICBwYWRkaW5nOiAwLjZlbTsgICAgIG1hcmdpbi1sZWZ0OiA1cHg7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7IH0gIDpob3N0ID4+PiAuYW5ub3RhdGlvbkxheWVyIC5wb3B1cCBoMSB7ICAgICBmb250LXNpemU6IDFlbTsgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjMDAwMDAwOyAgICAgcGFkZGluZy1ib3R0b206IDAuMmVtOyB9ICA6aG9zdCA+Pj4gLmFubm90YXRpb25MYXllciAucG9wdXAgcCB7ICAgICBwYWRkaW5nLXRvcDogMC4yZW07IH0gIDpob3N0ID4+PiAuYW5ub3RhdGlvbkxheWVyIC5oaWdobGlnaHRBbm5vdGF0aW9uLCAuYW5ub3RhdGlvbkxheWVyIC51bmRlcmxpbmVBbm5vdGF0aW9uLCAuYW5ub3RhdGlvbkxheWVyIC5zcXVpZ2dseUFubm90YXRpb24sIC5hbm5vdGF0aW9uTGF5ZXIgLnN0cmlrZW91dEFubm90YXRpb24sIC5hbm5vdGF0aW9uTGF5ZXIgLmZpbGVBdHRhY2htZW50QW5ub3RhdGlvbiB7ICAgICBjdXJzb3I6IHBvaW50ZXI7IH0gIDpob3N0ID4+PiAucGRmVmlld2VyIC5jYW52YXNXcmFwcGVyIHsgICAgIG92ZXJmbG93OiBoaWRkZW47IH0gIDpob3N0ID4+PiAucGRmVmlld2VyIC5wYWdlIHsgICAgIGRpcmVjdGlvbjogbHRyOyAgICAgd2lkdGg6IDgxNnB4OyAgICAgaGVpZ2h0OiAxMDU2cHg7ICAgICBtYXJnaW46IDFweCBhdXRvIC04cHggYXV0bzsgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsgICAgIG92ZXJmbG93OiB2aXNpYmxlOyAgICAgYm9yZGVyOiA5cHggc29saWQgdHJhbnNwYXJlbnQ7ICAgICBiYWNrZ3JvdW5kLWNsaXA6IGNvbnRlbnQtYm94OyAgICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IH0gIDpob3N0ID4+PiAucGRmVmlld2VyLnJlbW92ZVBhZ2VCb3JkZXJzIC5wYWdlIHsgICAgIG1hcmdpbjogMHB4IGF1dG8gMTBweCBhdXRvOyAgICAgYm9yZGVyOiBub25lOyB9ICA6aG9zdCA+Pj4gLnBkZlZpZXdlciAucGFnZSBjYW52YXMgeyAgICAgbWFyZ2luOiAwOyAgICAgZGlzcGxheTogYmxvY2s7IH0gIDpob3N0ID4+PiAucGRmVmlld2VyIC5wYWdlIC5sb2FkaW5nSWNvbiB7ICAgICBwb3NpdGlvbjogYWJzb2x1dGU7ICAgICBkaXNwbGF5OiBibG9jazsgICAgIGxlZnQ6IDA7ICAgICB0b3A6IDA7ICAgICByaWdodDogMDsgICAgIGJvdHRvbTogMDsgfSAgOmhvc3QgPj4+IC5sb2FkaW5nSWNvbiB7ICAgICB3aWR0aDogMTAwcHg7ICAgICBoZWlnaHQ6IDEwMHB4OyAgICAgbGVmdDogNTAlICFpbXBvcnRhbnQ7ICAgICB0b3A6IDUwJSAhaW1wb3J0YW50OyAgICAgIG1hcmdpbi10b3A6IC01MHB4OyAgICAgbWFyZ2luLWxlZnQ6IC01MHB4OyAgICAgIGZvbnQtc2l6ZTogNXB4OyAgICAgdGV4dC1pbmRlbnQ6IC05OTk5ZW07ICAgICBib3JkZXItdG9wOiAxLjFlbSBzb2xpZCByZ2JhKDMsMCwyLCAwLjIpOyAgICAgYm9yZGVyLXJpZ2h0OiAxLjFlbSBzb2xpZCByZ2JhKDMsMCwyLCAwLjIpOyAgICAgYm9yZGVyLWJvdHRvbTogMS4xZW0gc29saWQgcmdiYSgzLDAsMiwgMC4yKTsgICAgIGJvcmRlci1sZWZ0OiAxLjFlbSBzb2xpZCAjMDMwMDAyOyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVooMCk7ICAgICAtbXMtdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApOyAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVaKDApOyAgICAgLXdlYmtpdC1hbmltYXRpb246IGxvYWQ4IDEuMXMgaW5maW5pdGUgbGluZWFyOyAgICAgYW5pbWF0aW9uOiBsb2FkOCAxLjFzIGluZmluaXRlIGxpbmVhcjsgfSA6aG9zdCA+Pj4gLmxvYWRpbmdJY29uLCA6aG9zdCA+Pj4gLmxvYWRpbmdJY29uOmFmdGVyIHsgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsgfSBALXdlYmtpdC1rZXlmcmFtZXMgbG9hZDggeyAgICAgMCUgeyAgICAgICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7ICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7ICAgICB9ICAgICAxMDAlIHsgICAgICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7ICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgICAgIH0gfSBAa2V5ZnJhbWVzIGxvYWQ4IHsgICAgIDAlIHsgICAgICAgICAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKDBkZWcpOyAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpOyAgICAgfSAgICAgMTAwJSB7ICAgICAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpOyAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7ICAgICB9IH0gIDpob3N0ID4+PiAqIHsgICAgIHBhZGRpbmc6IDA7ICAgICBtYXJnaW46IDA7IH0gIDpob3N0ID4+PiBodG1sIHsgICAgIGhlaWdodDogMTAwJTsgICAgIHdpZHRoOiAxMDAlOyAgICAgLyogRm9udCBzaXplIGlzIG5lZWRlZCB0byBtYWtlIHRoZSBhY3Rpdml0eSBiYXIgdGhlIGNvcnJlY3Qgc2l6ZS4gKi8gICAgIGZvbnQtc2l6ZTogMTBweDsgfSAgOmhvc3QgPj4+IGJvZHkgeyAgICAgaGVpZ2h0OiAxMDAlOyAgICAgd2lkdGg6IDEwMCU7ICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDA0MDQwOyAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKGltYWdlcy90ZXh0dXJlLnBuZyk7IH0gIDpob3N0ID4+PiBib2R5LCBpbnB1dCwgYnV0dG9uLCBzZWxlY3QgeyAgICAgZm9udDogbWVzc2FnZS1ib3g7ICAgICBvdXRsaW5lOiBub25lOyB9ICA6aG9zdCA+Pj4gLmhpZGRlbiB7ICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7IH0gOmhvc3QgPj4+IFtoaWRkZW5dIHsgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsgfSAgICN2aWV3ZXItcGRmLWNvbnRhaW5lciB7ICAgICBvdmVyZmxvdzogYXV0bzsgICAgIC13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOiB0b3VjaDsgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsgICAgIHRvcDogMzJweDsgICAgIHJpZ2h0OiAwOyAgICAgYm90dG9tOiAwOyAgICAgbGVmdDogMDsgICAgIG91dGxpbmU6IG5vbmU7IH0gaHRtbFtkaXI9J2x0ciddICN2aWV3ZXItcGRmLWNvbnRhaW5lciB7ICAgICBib3gtc2hhZG93OiBpbnNldCAxcHggMCAwIGhzbGEoMCwwJSwxMDAlLC4wNSk7IH0gaHRtbFtkaXI9J3J0bCddICN2aWV3ZXItcGRmLWNvbnRhaW5lciB7ICAgICBib3gtc2hhZG93OiBpbnNldCAtMXB4IDAgMCBoc2xhKDAsMCUsMTAwJSwuMDUpOyB9XCJdLFxuICAgIHByb3ZpZGVyczogW1JlbmRlcmluZ1F1ZXVlU2VydmljZXNdXG59KVxuZXhwb3J0IGNsYXNzIFBkZlZpZXdlckNvbXBvbmVudCB7XG5cbiAgICBASW5wdXQoKVxuICAgIHVybEZpbGU6IHN0cmluZztcblxuICAgIEBJbnB1dCgpXG4gICAgbmFtZUZpbGU6IHN0cmluZztcblxuICAgIEBJbnB1dCgpXG4gICAgc2hvd1Rvb2xiYXI6IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgY3VycmVudFBkZkRvY3VtZW50OiBhbnk7XG4gICAgcGFnZTogbnVtYmVyO1xuICAgIGRpc3BsYXlQYWdlOiBudW1iZXI7XG4gICAgdG90YWxQYWdlczogbnVtYmVyO1xuICAgIGxhb2RpbmdQZXJjZW50OiBudW1iZXI7XG4gICAgcGRmVmlld2VyOiBhbnk7XG4gICAgY3VycmVudFNjYWxlTW9kZTogc3RyaW5nID0gJ2F1dG8nO1xuICAgIGN1cnJlbnRTY2FsZTogbnVtYmVyO1xuXG4gICAgTUFYX0FVVE9fU0NBTEU6IG51bWJlciA9IDEuMjU7XG4gICAgREVGQVVMVF9TQ0FMRV9ERUxUQTogbnVtYmVyID0gMS4xO1xuICAgIE1JTl9TQ0FMRTogbnVtYmVyID0gMC4yNTtcbiAgICBNQVhfU0NBTEU6IG51bWJlciA9IDEwLjA7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlbmRlcmluZ1F1ZXVlU2VydmljZXM6IFJlbmRlcmluZ1F1ZXVlU2VydmljZXMsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBsb2dTZXJ2aWNlOiBMb2dTZXJ2aWNlKSB7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoIXRoaXMudXJsRmlsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdHRyaWJ1dGUgdXJsRmlsZSBpcyByZXF1aXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMudXJsRmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbG9hZGluZ1Rhc2sgPSB0aGlzLmdldFBERkpTKCkuZ2V0RG9jdW1lbnQodGhpcy51cmxGaWxlKTtcblxuICAgICAgICAgICAgICAgIGxvYWRpbmdUYXNrLm9uUHJvZ3Jlc3MgPSAocHJvZ3Jlc3NEYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBsZXZlbCA9IHByb2dyZXNzRGF0YS5sb2FkZWQgLyBwcm9ncmVzc0RhdGEudG90YWw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFvZGluZ1BlcmNlbnQgPSBNYXRoLnJvdW5kKGxldmVsICogMTAwKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgbG9hZGluZ1Rhc2sudGhlbigocGRmRG9jdW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGRmRG9jdW1lbnQgPSBwZGZEb2N1bWVudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbFBhZ2VzID0gcGRmRG9jdW1lbnQubnVtUGFnZXM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZSA9IDE7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheVBhZ2UgPSAxO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRQREZWaWV3ZXIodGhpcy5jdXJyZW50UGRmRG9jdW1lbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBkZkRvY3VtZW50LmdldFBhZ2UoMSkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjYWxlUGFnZSgnYXV0bycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJldHVybiB0aGUgUERGSlMgZ2xvYmFsIG9iamVjdCAoZXhpc3QgdG8gZmFjaWxpdGF0ZSB0aGUgbW9jayBvZiBQREZKUyBpbiB0aGUgdGVzdClcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtQREZKU31cbiAgICAgKi9cbiAgICBnZXRQREZKUygpIHtcbiAgICAgICAgcmV0dXJuIFBERkpTO1xuICAgIH1cblxuICAgIGluaXRQREZWaWV3ZXIocGRmRG9jdW1lbnQ6IGFueSkge1xuICAgICAgICBQREZKUy52ZXJib3NpdHkgPSAxO1xuICAgICAgICBQREZKUy5kaXNhYmxlV29ya2VyID0gZmFsc2U7XG5cbiAgICAgICAgbGV0IGRvY3VtZW50Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZpZXdlci1wZGYtY29udGFpbmVyJyk7XG4gICAgICAgIGxldCB2aWV3ZXI6IGFueSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWV3ZXItdmlld2VyUGRmJyk7XG5cbiAgICAgICAgd2luZG93LmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy53YXRjaFNjcm9sbChldmVudC50YXJnZXQpO1xuICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICB0aGlzLnBkZlZpZXdlciA9IG5ldyBQREZKUy5QREZWaWV3ZXIoe1xuICAgICAgICAgICAgY29udGFpbmVyOiBkb2N1bWVudENvbnRhaW5lcixcbiAgICAgICAgICAgIHZpZXdlcjogdmlld2VyLFxuICAgICAgICAgICAgcmVuZGVyaW5nUXVldWU6IHRoaXMucmVuZGVyaW5nUXVldWVTZXJ2aWNlc1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnJlbmRlcmluZ1F1ZXVlU2VydmljZXMuc2V0Vmlld2VyKHRoaXMucGRmVmlld2VyKTtcblxuICAgICAgICB0aGlzLnBkZlZpZXdlci5zZXREb2N1bWVudChwZGZEb2N1bWVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRvIHNjYWxlIHRoZSBwYWdlIGN1cnJlbnQgc3VwcG9ydCBpbXBsZW1lbnRhdGlvblxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNjYWxlTW9kZSAtIG5ldyBzY2FsZSBtb2RlXG4gICAgICovXG4gICAgc2NhbGVQYWdlKHNjYWxlTW9kZSkge1xuICAgICAgICB0aGlzLmN1cnJlbnRTY2FsZU1vZGUgPSBzY2FsZU1vZGU7XG5cbiAgICAgICAgaWYgKHRoaXMucGRmVmlld2VyKSB7XG5cbiAgICAgICAgICAgIGxldCB2aWV3ZXJDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld2VyLW1haW4tY29udGFpbmVyJyk7XG4gICAgICAgICAgICBsZXQgZG9jdW1lbnRDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlld2VyLXBkZi1jb250YWluZXInKTtcblxuICAgICAgICAgICAgbGV0IHdpZHRoQ29udGFpbmVyO1xuICAgICAgICAgICAgbGV0IGhlaWd0aENvbnRhaW5lcjtcblxuICAgICAgICAgICAgaWYgKHZpZXdlckNvbnRhaW5lciAmJiB2aWV3ZXJDb250YWluZXIuY2xpZW50V2lkdGggPD0gZG9jdW1lbnRDb250YWluZXIuY2xpZW50V2lkdGgpIHtcbiAgICAgICAgICAgICAgICB3aWR0aENvbnRhaW5lciA9IHZpZXdlckNvbnRhaW5lci5jbGllbnRXaWR0aDtcbiAgICAgICAgICAgICAgICBoZWlndGhDb250YWluZXIgPSB2aWV3ZXJDb250YWluZXIuY2xpZW50SGVpZ2h0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3aWR0aENvbnRhaW5lciA9IGRvY3VtZW50Q29udGFpbmVyLmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgICAgIGhlaWd0aENvbnRhaW5lciA9IGRvY3VtZW50Q29udGFpbmVyLmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGV0IGN1cnJlbnRQYWdlID0gdGhpcy5wZGZWaWV3ZXIuX3BhZ2VzW3RoaXMucGRmVmlld2VyLl9jdXJyZW50UGFnZU51bWJlcl07XG5cbiAgICAgICAgICAgIGxldCBwYWRkaW5nID0gMjA7XG4gICAgICAgICAgICBsZXQgcGFnZVdpZHRoU2NhbGUgPSAod2lkdGhDb250YWluZXIgLSBwYWRkaW5nKSAvIGN1cnJlbnRQYWdlLndpZHRoICogY3VycmVudFBhZ2Uuc2NhbGU7XG4gICAgICAgICAgICBsZXQgcGFnZUhlaWdodFNjYWxlID0gKGhlaWd0aENvbnRhaW5lciAtIHBhZGRpbmcpIC8gY3VycmVudFBhZ2Uud2lkdGggKiBjdXJyZW50UGFnZS5zY2FsZTtcblxuICAgICAgICAgICAgbGV0IHNjYWxlO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuY3VycmVudFNjYWxlTW9kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3BhZ2UtYWN0dWFsJzpcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwYWdlLXdpZHRoJzpcbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBwYWdlV2lkdGhTY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncGFnZS1oZWlnaHQnOlxuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IHBhZ2VIZWlnaHRTY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncGFnZS1maXQnOlxuICAgICAgICAgICAgICAgICAgICBzY2FsZSA9IE1hdGgubWluKHBhZ2VXaWR0aFNjYWxlLCBwYWdlSGVpZ2h0U2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhdXRvJzpcbiAgICAgICAgICAgICAgICAgICAgbGV0IGhvcml6b250YWxTY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNMYW5kc2NhcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvcml6b250YWxTY2FsZSA9IE1hdGgubWluKHBhZ2VIZWlnaHRTY2FsZSwgcGFnZVdpZHRoU2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbFNjYWxlID0gcGFnZVdpZHRoU2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2NhbGUgPSBNYXRoLm1pbih0aGlzLk1BWF9BVVRPX1NDQUxFLCBob3Jpem9udGFsU2NhbGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nU2VydmljZS5lcnJvcigncGRmVmlld1NldFNjYWxlOiBcXCcnICsgc2NhbGVNb2RlICsgJ1xcJyBpcyBhbiB1bmtub3duIHpvb20gdmFsdWUuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5zZXRTY2FsZVVwZGF0ZVBhZ2VzKHNjYWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBhbGwgdGhlIHBhZ2VzIHdpdGggdGhlIG5ld1NjYWxlIHNjYWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbmV3U2NhbGUgLSBuZXcgc2NhbGUgcGFnZVxuICAgICAqL1xuICAgIHNldFNjYWxlVXBkYXRlUGFnZXMobmV3U2NhbGU6IG51bWJlcikge1xuICAgICAgICBpZiAoIXRoaXMuaXNTYW1lU2NhbGUodGhpcy5jdXJyZW50U2NhbGUsIG5ld1NjYWxlKSkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2NhbGUgPSBuZXdTY2FsZTtcblxuICAgICAgICAgICAgdGhpcy5wZGZWaWV3ZXIuX3BhZ2VzLmZvckVhY2goZnVuY3Rpb24gKGN1cnJlbnRQYWdlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFBhZ2UudXBkYXRlKG5ld1NjYWxlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLnBkZlZpZXdlci51cGRhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG1ldGhvZCB0byBjaGVjayBpZiB0aGUgcmVxdWVzdCBzY2FsZSBvZiB0aGUgcGFnZSBpcyB0aGUgc2FtZSBmb3IgYXZvaWQgdW51c2VmdWwgcmUtcmVuZGVyaW5nXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gb2xkU2NhbGUgLSBvbGQgc2NhbGUgcGFnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuZXdTY2FsZSAtIG5ldyBzY2FsZSBwYWdlXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBpc1NhbWVTY2FsZShvbGRTY2FsZTogbnVtYmVyLCBuZXdTY2FsZTogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiAobmV3U2NhbGUgPT09IG9sZFNjYWxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBtZXRob2QgdG8gY2hlY2sgaWYgaXMgYSBsYW5kIHNjYXBlIHZpZXdcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGlzTGFuZHNjYXBlKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiAod2lkdGggPiBoZWlnaHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0cmlnZ2VyZWQgd2hlbiB0aGUgcGFnZSBpcyByZXNpemVkXG4gICAgICovXG4gICAgb25SZXNpemUoKSB7XG4gICAgICAgIHRoaXMuc2NhbGVQYWdlKHRoaXMuY3VycmVudFNjYWxlTW9kZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdG9nZ2xlIHRoZSBmaXQgcGFnZSBwZGZcbiAgICAgKi9cbiAgICBwYWdlRml0KCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50U2NhbGVNb2RlICE9PSAncGFnZS1maXQnKSB7XG4gICAgICAgICAgICB0aGlzLnNjYWxlUGFnZSgncGFnZS1maXQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2NhbGVQYWdlKCdhdXRvJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB6b29tIGluIHBhZ2UgcGRmXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdGlja3NcbiAgICAgKi9cbiAgICB6b29tSW4odGlja3M6IG51bWJlcikge1xuICAgICAgICBsZXQgbmV3U2NhbGU6IGFueSA9IHRoaXMuY3VycmVudFNjYWxlO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXdTY2FsZSA9IChuZXdTY2FsZSAqIHRoaXMuREVGQVVMVF9TQ0FMRV9ERUxUQSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIG5ld1NjYWxlID0gTWF0aC5jZWlsKG5ld1NjYWxlICogMTApIC8gMTA7XG4gICAgICAgICAgICBuZXdTY2FsZSA9IE1hdGgubWluKHRoaXMuTUFYX1NDQUxFLCBuZXdTY2FsZSk7XG4gICAgICAgIH0gd2hpbGUgKC0tdGlja3MgPiAwICYmIG5ld1NjYWxlIDwgdGhpcy5NQVhfU0NBTEUpO1xuICAgICAgICB0aGlzLmN1cnJlbnRTY2FsZU1vZGUgPSAnYXV0byc7XG4gICAgICAgIHRoaXMuc2V0U2NhbGVVcGRhdGVQYWdlcyhuZXdTY2FsZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogem9vbSBvdXQgcGFnZSBwZGZcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aWNrc1xuICAgICAqL1xuICAgIHpvb21PdXQodGlja3M6IG51bWJlcikge1xuICAgICAgICBsZXQgbmV3U2NhbGU6IGFueSA9IHRoaXMuY3VycmVudFNjYWxlO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXdTY2FsZSA9IChuZXdTY2FsZSAvIHRoaXMuREVGQVVMVF9TQ0FMRV9ERUxUQSkudG9GaXhlZCgyKTtcbiAgICAgICAgICAgIG5ld1NjYWxlID0gTWF0aC5mbG9vcihuZXdTY2FsZSAqIDEwKSAvIDEwO1xuICAgICAgICAgICAgbmV3U2NhbGUgPSBNYXRoLm1heCh0aGlzLk1JTl9TQ0FMRSwgbmV3U2NhbGUpO1xuICAgICAgICB9IHdoaWxlICgtLXRpY2tzID4gMCAmJiBuZXdTY2FsZSA+IHRoaXMuTUlOX1NDQUxFKTtcbiAgICAgICAgdGhpcy5jdXJyZW50U2NhbGVNb2RlID0gJ2F1dG8nO1xuICAgICAgICB0aGlzLnNldFNjYWxlVXBkYXRlUGFnZXMobmV3U2NhbGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGxvYWQgdGhlIHByZXZpb3VzIHBhZ2VcbiAgICAgKi9cbiAgICBwcmV2aW91c1BhZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnBkZlZpZXdlciAmJiB0aGlzLnBhZ2UgPiAxKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UtLTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheVBhZ2UgPSB0aGlzLnBhZ2U7XG5cbiAgICAgICAgICAgIHRoaXMucGRmVmlld2VyLmN1cnJlbnRQYWdlTnVtYmVyID0gdGhpcy5wYWdlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbG9hZCB0aGUgbmV4dCBwYWdlXG4gICAgICovXG4gICAgbmV4dFBhZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnBkZlZpZXdlciAmJiB0aGlzLnBhZ2UgPCB0aGlzLnRvdGFsUGFnZXMpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZSsrO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5UGFnZSA9IHRoaXMucGFnZTtcblxuICAgICAgICAgICAgdGhpcy5wZGZWaWV3ZXIuY3VycmVudFBhZ2VOdW1iZXIgPSB0aGlzLnBhZ2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBsb2FkIHRoZSBwYWdlIGluIGlucHV0XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcGFnZSAtIHBhZ2UgdG8gbG9hZFxuICAgICAqL1xuICAgIGlucHV0UGFnZShwYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IHBhZ2VJbnB1dCA9IHBhcnNlSW50KHBhZ2UsIDEwKTtcblxuICAgICAgICBpZiAoIWlzTmFOKHBhZ2VJbnB1dCkgJiYgcGFnZUlucHV0ID4gMCAmJiBwYWdlSW5wdXQgPD0gdGhpcy50b3RhbFBhZ2VzKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2UgPSBwYWdlSW5wdXQ7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlQYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICAgICAgdGhpcy5wZGZWaWV3ZXIuY3VycmVudFBhZ2VOdW1iZXIgPSB0aGlzLnBhZ2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlQYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGl0ZW5lciBTY3JvbGwgRXZlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7YW55fSB0YXJnZXRcbiAgICAgKi9cbiAgICB3YXRjaFNjcm9sbCh0YXJnZXQpIHtcbiAgICAgICAgbGV0IG91dHB1dFBhZ2UgPSB0aGlzLmdldFZpc2libGVFbGVtZW50KHRhcmdldCk7XG5cbiAgICAgICAgaWYgKG91dHB1dFBhZ2UpIHtcbiAgICAgICAgICAgIHRoaXMucGFnZSA9IG91dHB1dFBhZ2UuaWQ7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlQYWdlID0gdGhpcy5wYWdlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZmluZCBvdXQgd2hhdCBlbGVtZW50cyBhcmUgdmlzaWJsZSB3aXRoaW4gYSBzY3JvbGwgcGFuZVxuICAgICAqXG4gICAgICogQHBhcmFtIHthbnl9IHRhcmdldFxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdH0gcGFnZVxuICAgICAqL1xuICAgIGdldFZpc2libGVFbGVtZW50KHRhcmdldCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wZGZWaWV3ZXIuX3BhZ2VzLmZpbmQoKHBhZ2UpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzT25TY3JlZW4ocGFnZSwgdGFyZ2V0KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY2hlY2sgaWYgYSBwYWdlIGlzIHZpc2libGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7YW55fSBwYWdlXG4gICAgICogQHBhcmFtIHthbnl9IHRhcmdldFxuICAgICAqXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICovXG4gICAgaXNPblNjcmVlbihwYWdlOiBhbnksIHRhcmdldDogYW55KSB7XG4gICAgICAgIGxldCB2aWV3cG9ydDogYW55ID0ge307XG4gICAgICAgIHZpZXdwb3J0LnRvcCA9IHRhcmdldC5zY3JvbGxUb3A7XG4gICAgICAgIHZpZXdwb3J0LmJvdHRvbSA9IHZpZXdwb3J0LnRvcCArIHRhcmdldC5zY3JvbGxIZWlnaHQ7XG4gICAgICAgIGxldCBib3VuZHM6IGFueSA9IHt9O1xuICAgICAgICBib3VuZHMudG9wID0gcGFnZS5kaXYub2Zmc2V0VG9wO1xuICAgICAgICBib3VuZHMuYm90dG9tID0gYm91bmRzLnRvcCArIHBhZ2Uudmlld3BvcnQuaGVpZ2h0O1xuICAgICAgICByZXR1cm4gKChib3VuZHMudG9wIDw9IHZpZXdwb3J0LmJvdHRvbSkgJiYgKGJvdW5kcy5ib3R0b20gPj0gdmlld3BvcnQudG9wKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIExpdGVuZXIgS2V5Ym9hcmQgRXZlbnRcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bicsIFsnJGV2ZW50J10pXG4gICAgaGFuZGxlS2V5Ym9hcmRFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBsZXQga2V5ID0gZXZlbnQua2V5Q29kZTtcbiAgICAgICAgaWYgKGtleSA9PT0gMzkpIHsgLy8gcmlnaHQgYXJyb3dcbiAgICAgICAgICAgIHRoaXMubmV4dFBhZ2UoKTtcbiAgICAgICAgfSBlbHNlIGlmIChrZXkgPT09IDM3KSB7Ly8gbGVmdCBhcnJvd1xuICAgICAgICAgICAgdGhpcy5wcmV2aW91c1BhZ2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxufVxuIl19
