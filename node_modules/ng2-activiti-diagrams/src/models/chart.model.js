/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Chart = (function () {
    function Chart(obj) {
        this.id = obj && obj.id || null;
        if (obj && obj.type) {
            this.type = this.convertType(obj.type);
        }
    }
    Chart.prototype.convertType = function (type) {
        var chartType = '';
        switch (type) {
            case 'pieChart':
                chartType = 'pie';
                break;
            case 'table':
                chartType = 'table';
                break;
            case 'line':
                chartType = 'line';
                break;
            case 'barChart':
                chartType = 'bar';
                break;
            case 'processDefinitionHeatMap':
                chartType = 'HeatMap';
                break;
            default:
                chartType = 'table';
                break;
        }
        return chartType;
    };
    return Chart;
}());
exports.Chart = Chart;
var LineChart = (function (_super) {
    __extends(LineChart, _super);
    function LineChart(obj) {
        var _this = _super.call(this, obj) || this;
        _this.labels = [];
        _this.datasets = [];
        _this.title = obj && obj.title || null;
        _this.titleKey = obj && obj.titleKey || null;
        _this.labels = obj && obj.columnNames.slice(1, obj.columnNames.length);
        obj.rows.forEach(function (value) {
            _this.datasets.push({ data: value.slice(1, value.length), label: value[0] });
        });
        return _this;
    }
    return LineChart;
}(Chart));
exports.LineChart = LineChart;
var BarChart = (function (_super) {
    __extends(BarChart, _super);
    function BarChart(obj) {
        var _this = _super.call(this, obj) || this;
        _this.labels = [];
        _this.datasets = [];
        _this.data = [];
        _this.options = {
            scales: {
                yAxes: [{
                        ticks: {
                            beginAtZero: true,
                            stepSize: 1
                        }
                    }]
            }
        };
        _this.title = obj && obj.title || null;
        _this.titleKey = obj && obj.titleKey || null;
        obj.values.forEach(function (params) {
            var dataValue = [];
            params.values.forEach(function (info) {
                info.forEach(function (value, index) {
                    if (index % 2 === 0) {
                        _this.labels.push(value);
                    }
                    else {
                        dataValue.push(value);
                    }
                });
            });
            if (dataValue && dataValue.length > 0) {
                _this.datasets.push({ data: dataValue, label: params.key });
            }
        });
        return _this;
    }
    BarChart.prototype.hasDatasets = function () {
        return this.datasets && this.datasets.length > 0 ? true : false;
    };
    return BarChart;
}(Chart));
exports.BarChart = BarChart;
var TableChart = (function (_super) {
    __extends(TableChart, _super);
    function TableChart(obj) {
        var _this = _super.call(this, obj) || this;
        _this.labels = [];
        _this.datasets = [];
        _this.title = obj && obj.title || null;
        _this.titleKey = obj && obj.titleKey || null;
        _this.labels = obj && obj.columnNames;
        if (obj.rows) {
            _this.datasets = obj && obj.rows;
        }
        return _this;
    }
    TableChart.prototype.hasDatasets = function () {
        return this.datasets && this.datasets.length > 0 ? true : false;
    };
    return TableChart;
}(Chart));
exports.TableChart = TableChart;
var HeatMapChart = (function (_super) {
    __extends(HeatMapChart, _super);
    function HeatMapChart(obj) {
        var _this = _super.call(this, obj) || this;
        _this.avgTimePercentages = obj && obj.avgTimePercentages || null;
        _this.avgTimeValues = obj && obj.avgTimeValues || null;
        _this.processDefinitionId = obj && obj.processDefinitionId || null;
        _this.totalCountValues = obj && obj.totalCountValues || null;
        _this.titleKey = obj && obj.titleKey || null;
        _this.totalCountsPercentages = obj && obj.totalCountsPercentages || null;
        _this.totalTimePercentages = obj && obj.totalTimePercentages || null;
        _this.totalTimeValues = obj && obj.totalTimeValues || null;
        return _this;
    }
    return HeatMapChart;
}(Chart));
exports.HeatMapChart = HeatMapChart;
var PieChart = (function (_super) {
    __extends(PieChart, _super);
    function PieChart(obj) {
        var _this = _super.call(this, obj) || this;
        _this.labels = [];
        _this.data = [];
        _this.title = obj && obj.title || null;
        _this.titleKey = obj && obj.titleKey || null;
        if (obj.values) {
            obj.values.forEach(function (value) {
                _this.add(value.key, value.y);
            });
        }
        return _this;
    }
    PieChart.prototype.add = function (label, data) {
        this.labels.push(label);
        this.data.push(data);
    };
    PieChart.prototype.hasData = function () {
        return this.data && this.data.length > 0 ? true : false;
    };
    return PieChart;
}(Chart));
exports.PieChart = PieChart;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVscy9jaGFydC5tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7O0dBZUc7Ozs7Ozs7QUFFSDtJQUlJLGVBQVksR0FBUztRQUNqQixJQUFJLENBQUMsRUFBRSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsRUFBRSxJQUFJLElBQUksQ0FBQztRQUNoQyxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDbEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQyxDQUFDO0lBQ0wsQ0FBQztJQUVPLDJCQUFXLEdBQW5CLFVBQW9CLElBQVk7UUFDNUIsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ25CLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDWCxLQUFLLFVBQVU7Z0JBQ1gsU0FBUyxHQUFHLEtBQUssQ0FBQztnQkFDbEIsS0FBSyxDQUFDO1lBQ1YsS0FBSyxPQUFPO2dCQUNSLFNBQVMsR0FBRyxPQUFPLENBQUM7Z0JBQ3BCLEtBQUssQ0FBQztZQUNWLEtBQUssTUFBTTtnQkFDUCxTQUFTLEdBQUcsTUFBTSxDQUFDO2dCQUNuQixLQUFLLENBQUM7WUFDVixLQUFLLFVBQVU7Z0JBQ1gsU0FBUyxHQUFHLEtBQUssQ0FBQztnQkFDbEIsS0FBSyxDQUFDO1lBQ1YsS0FBSywwQkFBMEI7Z0JBQzNCLFNBQVMsR0FBRyxTQUFTLENBQUM7Z0JBQ3RCLEtBQUssQ0FBQztZQUNWO2dCQUNJLFNBQVMsR0FBRyxPQUFPLENBQUM7Z0JBQ3BCLEtBQUssQ0FBQztRQUNkLENBQUM7UUFDRCxNQUFNLENBQUMsU0FBUyxDQUFDO0lBQ3JCLENBQUM7SUFDTCxZQUFDO0FBQUQsQ0FuQ0EsQUFtQ0MsSUFBQTtBQW5DWSxzQkFBSztBQXFDbEI7SUFBK0IsNkJBQUs7SUFNaEMsbUJB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OztJQUNMLENBQUM7SUFFRCxzQkFBRyxHQUFILFVBQUksS0FBYSxFQUFFLElBQVk7UUFDM0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDeEIsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDekIsQ0FBQztJQUVELDBCQUFPLEdBQVA7UUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQztJQUM1RCxDQUFDO0lBQ0wsZUFBQztBQUFELENBekJBLEFBeUJDLENBekI2QixLQUFLLEdBeUJsQztBQXpCWSw0QkFBUSIsImZpbGUiOiJtb2RlbHMvY2hhcnQubW9kZWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNiBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5leHBvcnQgY2xhc3MgQ2hhcnQge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdHlwZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3Iob2JqPzogYW55KSB7XG4gICAgICAgIHRoaXMuaWQgPSBvYmogJiYgb2JqLmlkIHx8IG51bGw7XG4gICAgICAgIGlmIChvYmogJiYgb2JqLnR5cGUpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMuY29udmVydFR5cGUob2JqLnR5cGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjb252ZXJ0VHlwZSh0eXBlOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IGNoYXJ0VHlwZSA9ICcnO1xuICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3BpZUNoYXJ0JzpcbiAgICAgICAgICAgICAgICBjaGFydFR5cGUgPSAncGllJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3RhYmxlJzpcbiAgICAgICAgICAgICAgICBjaGFydFR5cGUgPSAndGFibGUnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbGluZSc6XG4gICAgICAgICAgICAgICAgY2hhcnRUeXBlID0gJ2xpbmUnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnYmFyQ2hhcnQnOlxuICAgICAgICAgICAgICAgIGNoYXJ0VHlwZSA9ICdiYXInO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncHJvY2Vzc0RlZmluaXRpb25IZWF0TWFwJzpcbiAgICAgICAgICAgICAgICBjaGFydFR5cGUgPSAnSGVhdE1hcCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoYXJ0VHlwZSA9ICd0YWJsZSc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoYXJ0VHlwZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMaW5lQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICB0aXRsZUtleTogc3RyaW5nO1xuICAgIGxhYmVsczogc3RyaW5nW10gPSBbXTtcbiAgICBkYXRhc2V0czogYW55W10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKG9iaj86IGFueSkge1xuICAgICAgICBzdXBlcihvYmopO1xuICAgICAgICB0aGlzLnRpdGxlID0gb2JqICYmIG9iai50aXRsZSB8fCBudWxsO1xuICAgICAgICB0aGlzLnRpdGxlS2V5ID0gb2JqICYmIG9iai50aXRsZUtleSB8fCBudWxsO1xuICAgICAgICB0aGlzLmxhYmVscyA9IG9iaiAmJiBvYmouY29sdW1uTmFtZXMuc2xpY2UoMSwgb2JqLmNvbHVtbk5hbWVzLmxlbmd0aCk7XG5cbiAgICAgICAgb2JqLnJvd3MuZm9yRWFjaCgodmFsdWU6IGFueSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kYXRhc2V0cy5wdXNoKHtkYXRhOiB2YWx1ZS5zbGljZSgxLCB2YWx1ZS5sZW5ndGgpLCBsYWJlbDogdmFsdWVbMF19KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQmFyQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICB0aXRsZUtleTogc3RyaW5nO1xuICAgIGxhYmVsczogc3RyaW5nW10gPSBbXTtcbiAgICBkYXRhc2V0czogYW55W10gPSBbXTtcbiAgICBkYXRhOiBhbnlbXSA9IFtdO1xuICAgIG9wdGlvbnM6IGFueSA9IHtcbiAgICAgICAgc2NhbGVzOiB7XG4gICAgICAgICAgICB5QXhlczogW3tcbiAgICAgICAgICAgICAgICB0aWNrczoge1xuICAgICAgICAgICAgICAgICAgICBiZWdpbkF0WmVybzogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgc3RlcFNpemU6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKG9iaj86IGFueSkge1xuICAgICAgICBzdXBlcihvYmopO1xuICAgICAgICB0aGlzLnRpdGxlID0gb2JqICYmIG9iai50aXRsZSB8fCBudWxsO1xuICAgICAgICB0aGlzLnRpdGxlS2V5ID0gb2JqICYmIG9iai50aXRsZUtleSB8fCBudWxsO1xuICAgICAgICBvYmoudmFsdWVzLmZvckVhY2goKHBhcmFtczogYW55KSA9PiB7XG4gICAgICAgICAgICBsZXQgZGF0YVZhbHVlID0gW107XG4gICAgICAgICAgICBwYXJhbXMudmFsdWVzLmZvckVhY2goKGluZm86IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGluZm8uZm9yRWFjaCgodmFsdWU6IGFueSwgaW5kZXg6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggJSAyID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxhYmVscy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFWYWx1ZS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoZGF0YVZhbHVlICYmIGRhdGFWYWx1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhc2V0cy5wdXNoKHtkYXRhOiBkYXRhVmFsdWUsIGxhYmVsOiBwYXJhbXMua2V5fSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhc0RhdGFzZXRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhc2V0cyAmJiB0aGlzLmRhdGFzZXRzLmxlbmd0aCA+IDAgPyB0cnVlIDogZmFsc2U7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgVGFibGVDaGFydCBleHRlbmRzIENoYXJ0IHtcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHRpdGxlS2V5OiBzdHJpbmc7XG4gICAgbGFiZWxzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGRhdGFzZXRzOiBhbnlbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3Iob2JqPzogYW55KSB7XG4gICAgICAgIHN1cGVyKG9iaik7XG4gICAgICAgIHRoaXMudGl0bGUgPSBvYmogJiYgb2JqLnRpdGxlIHx8IG51bGw7XG4gICAgICAgIHRoaXMudGl0bGVLZXkgPSBvYmogJiYgb2JqLnRpdGxlS2V5IHx8IG51bGw7XG4gICAgICAgIHRoaXMubGFiZWxzID0gb2JqICYmIG9iai5jb2x1bW5OYW1lcztcbiAgICAgICAgaWYgKG9iai5yb3dzKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFzZXRzID0gb2JqICYmIG9iai5yb3dzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFzRGF0YXNldHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGFzZXRzICYmIHRoaXMuZGF0YXNldHMubGVuZ3RoID4gMCA/IHRydWUgOiBmYWxzZTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBIZWF0TWFwQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gICAgYXZnVGltZVBlcmNlbnRhZ2VzOiBzdHJpbmc7XG4gICAgYXZnVGltZVZhbHVlczogc3RyaW5nO1xuICAgIHByb2Nlc3NEZWZpbml0aW9uSWQ6IHN0cmluZztcbiAgICB0aXRsZUtleTogc3RyaW5nO1xuICAgIHRvdGFsQ291bnRWYWx1ZXM6IHN0cmluZztcbiAgICB0b3RhbENvdW50c1BlcmNlbnRhZ2VzOiBzdHJpbmc7XG4gICAgdG90YWxUaW1lUGVyY2VudGFnZXM6IHN0cmluZztcbiAgICB0b3RhbFRpbWVWYWx1ZXM6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKG9iaj86IGFueSkge1xuICAgICAgICBzdXBlcihvYmopO1xuICAgICAgICB0aGlzLmF2Z1RpbWVQZXJjZW50YWdlcyA9IG9iaiAmJiBvYmouYXZnVGltZVBlcmNlbnRhZ2VzIHx8IG51bGw7XG4gICAgICAgIHRoaXMuYXZnVGltZVZhbHVlcyA9IG9iaiAmJiBvYmouYXZnVGltZVZhbHVlcyB8fCBudWxsO1xuICAgICAgICB0aGlzLnByb2Nlc3NEZWZpbml0aW9uSWQgPSBvYmogJiYgb2JqLnByb2Nlc3NEZWZpbml0aW9uSWQgfHwgbnVsbDtcbiAgICAgICAgdGhpcy50b3RhbENvdW50VmFsdWVzID0gb2JqICYmIG9iai50b3RhbENvdW50VmFsdWVzIHx8IG51bGw7XG4gICAgICAgIHRoaXMudGl0bGVLZXkgPSBvYmogJiYgb2JqLnRpdGxlS2V5IHx8IG51bGw7XG4gICAgICAgIHRoaXMudG90YWxDb3VudHNQZXJjZW50YWdlcyA9IG9iaiAmJiBvYmoudG90YWxDb3VudHNQZXJjZW50YWdlcyB8fCBudWxsO1xuICAgICAgICB0aGlzLnRvdGFsVGltZVBlcmNlbnRhZ2VzID0gb2JqICYmIG9iai50b3RhbFRpbWVQZXJjZW50YWdlcyB8fCBudWxsO1xuICAgICAgICB0aGlzLnRvdGFsVGltZVZhbHVlcyA9IG9iaiAmJiBvYmoudG90YWxUaW1lVmFsdWVzIHx8IG51bGw7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGllQ2hhcnQgZXh0ZW5kcyBDaGFydCB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICB0aXRsZUtleTogc3RyaW5nO1xuICAgIGxhYmVsczogc3RyaW5nW10gPSBbXTtcbiAgICBkYXRhOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3Iob2JqPzogYW55KSB7XG4gICAgICAgIHN1cGVyKG9iaik7XG4gICAgICAgIHRoaXMudGl0bGUgPSBvYmogJiYgb2JqLnRpdGxlIHx8IG51bGw7XG4gICAgICAgIHRoaXMudGl0bGVLZXkgPSBvYmogJiYgb2JqLnRpdGxlS2V5IHx8IG51bGw7XG4gICAgICAgIGlmIChvYmoudmFsdWVzKSB7XG4gICAgICAgICAgICBvYmoudmFsdWVzLmZvckVhY2goKHZhbHVlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZCh2YWx1ZS5rZXksIHZhbHVlLnkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGQobGFiZWw6IHN0cmluZywgZGF0YTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMubGFiZWxzLnB1c2gobGFiZWwpO1xuICAgICAgICB0aGlzLmRhdGEucHVzaChkYXRhKTtcbiAgICB9XG5cbiAgICBoYXNEYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhICYmIHRoaXMuZGF0YS5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH1cbn1cbiJdfQ==
