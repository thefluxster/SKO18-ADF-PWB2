/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("@angular/core");
var index_1 = require("./core/index");
var WidgetComponent = (function () {
    function WidgetComponent() {
        this.fieldChanged = new core_1.EventEmitter();
    }
    WidgetComponent.prototype.hasField = function () {
        return this.field ? true : false;
    };
    WidgetComponent.prototype.isRequired = function () {
        if (this.field && this.field.required) {
            return true;
        }
        return null;
    };
    WidgetComponent.prototype.hasValue = function () {
        return this.field &&
            this.field.value !== null &&
            this.field.value !== undefined;
    };
    WidgetComponent.prototype.ngAfterViewInit = function () {
        this.setupMaterialComponents(componentHandler);
        this.fieldChanged.emit(this.field);
    };
    WidgetComponent.prototype.setupMaterialComponents = function (handler) {
        if (handler) {
            handler.upgradeAllRegistered();
            return true;
        }
        return false;
    };
    WidgetComponent.prototype.setupMaterialTextField = function (elementRef, handler, value) {
        if (elementRef && handler) {
            var el = elementRef.nativeElement;
            if (el) {
                var container = el.querySelector('.mdl-textfield');
                if (container) {
                    container.MaterialTextfield.change(value);
                    return true;
                }
            }
        }
        return false;
    };
    WidgetComponent.prototype.checkVisibility = function (field) {
        console.log('WidgetComponent.checkVisibility was used only to trigger visibility engine, components should do that internally if needed');
        this.fieldChanged.emit(field);
    };
    WidgetComponent.prototype.onFieldChanged = function (field) {
        console.log('WidgetComponent.onFieldChanged was used only to trigger visibility engine, components should do that internally if needed');
        this.fieldChanged.emit(field);
    };
    WidgetComponent.prototype.getHyperlinkUrl = function (field) {
        var url = WidgetComponent.DEFAULT_HYPERLINK_URL;
        if (field && field.hyperlinkUrl) {
            url = field.hyperlinkUrl;
            if (!/^https?:\/\//i.test(url)) {
                url = "" + WidgetComponent.DEFAULT_HYPERLINK_SCHEME + url;
            }
        }
        return url;
    };
    WidgetComponent.prototype.getHyperlinkText = function (field) {
        if (field) {
            return field.displayText || field.hyperlinkUrl;
        }
        return null;
    };
    return WidgetComponent;
}());
WidgetComponent.DEFAULT_HYPERLINK_URL = '#';
WidgetComponent.DEFAULT_HYPERLINK_SCHEME = 'http://';
__decorate([
    core_1.Input(),
    __metadata("design:type", index_1.FormFieldModel)
], WidgetComponent.prototype, "field", void 0);
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], WidgetComponent.prototype, "fieldChanged", void 0);
exports.WidgetComponent = WidgetComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvd2lkZ2V0cy93aWRnZXQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7Ozs7Ozs7Ozs7QUFFSCxzQ0FBdUY7QUFDdkYsc0NBQThDO0FBTzlDO0lBQUE7UUFVSSxpQkFBWSxHQUFpQyxJQUFJLG1CQUFZLEVBQWtCLENBQUM7SUE4RXBGLENBQUM7SUE1RUcsa0NBQVEsR0FBUjtRQUNJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksR0FBRyxLQUFLLENBQUM7SUFDckMsQ0FBQztJQUlELG9DQUFVLEdBQVY7UUFDSSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsSUFBSSxDQUFDO1FBQ2hCLENBQUM7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxrQ0FBUSxHQUFSO1FBQ0ksTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLO1lBQ2IsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEtBQUssSUFBSTtZQUN6QixJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUM7SUFDdkMsQ0FBQztJQUVELHlDQUFlLEdBQWY7UUFDSSxJQUFJLENBQUMsdUJBQXVCLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUVELGlEQUF1QixHQUF2QixVQUF3QixPQUFhO1FBRWpDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDVixPQUFPLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztZQUMvQixNQUFNLENBQUMsSUFBSSxDQUFDO1FBQ2hCLENBQUM7UUFDRCxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxnREFBc0IsR0FBdEIsVUFBdUIsVUFBc0IsRUFBRSxPQUFZLEVBQUUsS0FBYTtRQUN0RSxFQUFFLENBQUMsQ0FBQyxVQUFVLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQztZQUN4QixJQUFJLEVBQUUsR0FBRyxVQUFVLENBQUMsYUFBYSxDQUFDO1lBQ2xDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ0wsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2dCQUNuRCxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO29CQUNaLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQzFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7Z0JBQ2hCLENBQUM7WUFDTCxDQUFDO1FBQ0wsQ0FBQztRQUNELE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUdELHlDQUFlLEdBQWYsVUFBZ0IsS0FBcUI7UUFDakMsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0SEFBNEgsQ0FBQyxDQUFDO1FBQzFJLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFHRCx3Q0FBYyxHQUFkLFVBQWUsS0FBcUI7UUFDaEMsT0FBTyxDQUFDLEdBQUcsQ0FBQywySEFBMkgsQ0FBQyxDQUFDO1FBQ3pJLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFUyx5Q0FBZSxHQUF6QixVQUEwQixLQUFxQjtRQUMzQyxJQUFJLEdBQUcsR0FBRyxlQUFlLENBQUMscUJBQXFCLENBQUM7UUFDaEQsRUFBRSxDQUFDLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1lBQzlCLEdBQUcsR0FBRyxLQUFLLENBQUMsWUFBWSxDQUFDO1lBQ3pCLEVBQUUsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdCLEdBQUcsR0FBRyxLQUFHLGVBQWUsQ0FBQyx3QkFBd0IsR0FBRyxHQUFLLENBQUM7WUFDOUQsQ0FBQztRQUNMLENBQUM7UUFDRCxNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQztJQUVTLDBDQUFnQixHQUExQixVQUEyQixLQUFxQjtRQUM1QyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ1IsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXLElBQUksS0FBSyxDQUFDLFlBQVksQ0FBQztRQUNuRCxDQUFDO1FBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQztJQUNoQixDQUFDO0lBQ0wsc0JBQUM7QUFBRCxDQXhGQSxBQXdGQztBQXRGVSxxQ0FBcUIsR0FBVyxHQUFHLENBQUM7QUFDcEMsd0NBQXdCLEdBQVcsU0FBUyxDQUFDO0FBR3BEO0lBREMsWUFBSyxFQUFFOzhCQUNELHNCQUFjOzhDQUFDO0FBSXRCO0lBREMsYUFBTSxFQUFFOzhCQUNLLG1CQUFZO3FEQUFzRDtBQVZ2RSwwQ0FBZSIsImZpbGUiOiJjb21wb25lbnRzL3dpZGdldHMvd2lkZ2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE2IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IElucHV0LCBBZnRlclZpZXdJbml0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRm9ybUZpZWxkTW9kZWwgfSBmcm9tICcuL2NvcmUvaW5kZXgnO1xuXG5kZWNsYXJlIHZhciBjb21wb25lbnRIYW5kbGVyOiBhbnk7XG5cbi8qKlxuICogQmFzZSB3aWRnZXQgY29tcG9uZW50LlxuICovXG5leHBvcnQgY2xhc3MgV2lkZ2V0Q29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCB7XG5cbiAgICBzdGF0aWMgREVGQVVMVF9IWVBFUkxJTktfVVJMOiBzdHJpbmcgPSAnIyc7XG4gICAgc3RhdGljIERFRkFVTFRfSFlQRVJMSU5LX1NDSEVNRTogc3RyaW5nID0gJ2h0dHA6Ly8nO1xuXG4gICAgQElucHV0KClcbiAgICBmaWVsZDogRm9ybUZpZWxkTW9kZWw7XG5cbiAgICAvKiogQGRlcHJlY2F0ZWQgdXNlZCBvbmx5IHRvIHRyaWdnZXIgdmlzaWJpbGl0eSBlbmdpbmUsIGNvbXBvbmVudHMgc2hvdWxkIGRvIHRoYXQgaW50ZXJuYWxseSBpZiBuZWVkZWQgKi9cbiAgICBAT3V0cHV0KClcbiAgICBmaWVsZENoYW5nZWQ6IEV2ZW50RW1pdHRlcjxGb3JtRmllbGRNb2RlbD4gPSBuZXcgRXZlbnRFbWl0dGVyPEZvcm1GaWVsZE1vZGVsPigpO1xuXG4gICAgaGFzRmllbGQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIE5vdGUgZm9yIGRldmVsb3BlcnM6XG4gICAgLy8gcmV0dXJucyA8YW55PiBvYmplY3QgdG8gYmUgYWJsZSBiaW5kaW5nIGl0IHRvIHRoZSA8ZWxlbWVudCByZWd1aXJlZD1cInJlcXVpcmVkXCI+IGF0dHJpYnV0ZVxuICAgIGlzUmVxdWlyZWQoKTogYW55IHtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQgJiYgdGhpcy5maWVsZC5yZXF1aXJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaGFzVmFsdWUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkLnZhbHVlICE9PSBudWxsICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkLnZhbHVlICE9PSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLnNldHVwTWF0ZXJpYWxDb21wb25lbnRzKGNvbXBvbmVudEhhbmRsZXIpO1xuICAgICAgICB0aGlzLmZpZWxkQ2hhbmdlZC5lbWl0KHRoaXMuZmllbGQpO1xuICAgIH1cblxuICAgIHNldHVwTWF0ZXJpYWxDb21wb25lbnRzKGhhbmRsZXI/OiBhbnkpOiBib29sZWFuIHtcbiAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgTURMIGlzc3VlcyB3aXRoIGR5bmFtaWMgY29tcG9uZW50c1xuICAgICAgICBpZiAoaGFuZGxlcikge1xuICAgICAgICAgICAgaGFuZGxlci51cGdyYWRlQWxsUmVnaXN0ZXJlZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHNldHVwTWF0ZXJpYWxUZXh0RmllbGQoZWxlbWVudFJlZjogRWxlbWVudFJlZiwgaGFuZGxlcjogYW55LCB2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChlbGVtZW50UmVmICYmIGhhbmRsZXIpIHtcbiAgICAgICAgICAgIGxldCBlbCA9IGVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChlbCkge1xuICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBlbC5xdWVyeVNlbGVjdG9yKCcubWRsLXRleHRmaWVsZCcpO1xuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLk1hdGVyaWFsVGV4dGZpZWxkLmNoYW5nZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqIEBkZXByZWNhdGVkIHVzZWQgb25seSB0byB0cmlnZ2VyIHZpc2liaWxpdHkgZW5naW5lLCBjb21wb25lbnRzIHNob3VsZCBkbyB0aGF0IGludGVybmFsbHkgaWYgbmVlZGVkICovXG4gICAgY2hlY2tWaXNpYmlsaXR5KGZpZWxkOiBGb3JtRmllbGRNb2RlbCkge1xuICAgICAgICBjb25zb2xlLmxvZygnV2lkZ2V0Q29tcG9uZW50LmNoZWNrVmlzaWJpbGl0eSB3YXMgdXNlZCBvbmx5IHRvIHRyaWdnZXIgdmlzaWJpbGl0eSBlbmdpbmUsIGNvbXBvbmVudHMgc2hvdWxkIGRvIHRoYXQgaW50ZXJuYWxseSBpZiBuZWVkZWQnKTtcbiAgICAgICAgdGhpcy5maWVsZENoYW5nZWQuZW1pdChmaWVsZCk7XG4gICAgfVxuXG4gICAgLyoqIEBkZXByZWNhdGVkIHVzZWQgb25seSB0byB0cmlnZ2VyIHZpc2liaWxpdHkgZW5naW5lLCBjb21wb25lbnRzIHNob3VsZCBkbyB0aGF0IGludGVybmFsbHkgaWYgbmVlZGVkICovXG4gICAgb25GaWVsZENoYW5nZWQoZmllbGQ6IEZvcm1GaWVsZE1vZGVsKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdXaWRnZXRDb21wb25lbnQub25GaWVsZENoYW5nZWQgd2FzIHVzZWQgb25seSB0byB0cmlnZ2VyIHZpc2liaWxpdHkgZW5naW5lLCBjb21wb25lbnRzIHNob3VsZCBkbyB0aGF0IGludGVybmFsbHkgaWYgbmVlZGVkJyk7XG4gICAgICAgIHRoaXMuZmllbGRDaGFuZ2VkLmVtaXQoZmllbGQpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRIeXBlcmxpbmtVcmwoZmllbGQ6IEZvcm1GaWVsZE1vZGVsKSB7XG4gICAgICAgIGxldCB1cmwgPSBXaWRnZXRDb21wb25lbnQuREVGQVVMVF9IWVBFUkxJTktfVVJMO1xuICAgICAgICBpZiAoZmllbGQgJiYgZmllbGQuaHlwZXJsaW5rVXJsKSB7XG4gICAgICAgICAgICB1cmwgPSBmaWVsZC5oeXBlcmxpbmtVcmw7XG4gICAgICAgICAgICBpZiAoIS9eaHR0cHM/OlxcL1xcLy9pLnRlc3QodXJsKSkge1xuICAgICAgICAgICAgICAgIHVybCA9IGAke1dpZGdldENvbXBvbmVudC5ERUZBVUxUX0hZUEVSTElOS19TQ0hFTUV9JHt1cmx9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRIeXBlcmxpbmtUZXh0KGZpZWxkOiBGb3JtRmllbGRNb2RlbCkge1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWVsZC5kaXNwbGF5VGV4dCB8fCBmaWVsZC5oeXBlcmxpbmtVcmw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuIl19
