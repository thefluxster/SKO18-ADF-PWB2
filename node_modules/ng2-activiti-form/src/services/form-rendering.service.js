/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("@angular/core");
var index_1 = require("./../components/widgets/index");
var FormRenderingService = (function () {
    function FormRenderingService() {
        this.types = {
            'text': DefaultTypeResolver.fromType(index_1.TextWidget),
            'integer': DefaultTypeResolver.fromType(index_1.NumberWidget),
            'multi-line-text': DefaultTypeResolver.fromType(index_1.MultilineTextWidget),
            'boolean': DefaultTypeResolver.fromType(index_1.CheckboxWidget),
            'dropdown': DefaultTypeResolver.fromType(index_1.DropdownWidget),
            'date': DefaultTypeResolver.fromType(index_1.DateWidget),
            'amount': DefaultTypeResolver.fromType(index_1.AmountWidget),
            'radio-buttons': DefaultTypeResolver.fromType(index_1.RadioButtonsWidget),
            'hyperlink': DefaultTypeResolver.fromType(index_1.HyperlinkWidget),
            'readonly': DefaultTypeResolver.fromType(index_1.DisplayValueWidget),
            'readonly-text': DefaultTypeResolver.fromType(index_1.DisplayTextWidget),
            'typeahead': DefaultTypeResolver.fromType(index_1.TypeaheadWidget),
            'people': DefaultTypeResolver.fromType(index_1.PeopleWidget),
            'functional-group': DefaultTypeResolver.fromType(index_1.FunctionalGroupWidget),
            'dynamic-table': DefaultTypeResolver.fromType(index_1.DynamicTableWidget),
            'container': DefaultTypeResolver.fromType(index_1.ContainerWidget),
            'group': DefaultTypeResolver.fromType(index_1.ContainerWidget)
        };
        this.types['upload'] = function (field) {
            if (field) {
                var params = field.params;
                if (params && params.link) {
                    return index_1.AttachWidget;
                }
                return index_1.UploadWidget;
            }
            return index_1.UnknownWidget;
        };
    }
    FormRenderingService.prototype.getComponentTypeResolver = function (fieldType, defaultValue) {
        if (defaultValue === void 0) { defaultValue = index_1.UnknownWidget; }
        if (fieldType) {
            return this.types[fieldType] || DefaultTypeResolver.fromType(defaultValue);
        }
        return DefaultTypeResolver.fromType(defaultValue);
    };
    FormRenderingService.prototype.setComponentTypeResolver = function (fieldType, resolver, override) {
        if (override === void 0) { override = false; }
        if (!fieldType) {
            throw new Error("fieldType is null or not defined");
        }
        if (!resolver) {
            throw new Error("resolver is null or not defined");
        }
        var existing = this.types[fieldType];
        if (existing && !override) {
            throw new Error("already mapped, use override option if you intend replacing existing mapping.");
        }
        this.types[fieldType] = resolver;
    };
    FormRenderingService.prototype.resolveComponentType = function (field, defaultValue) {
        if (defaultValue === void 0) { defaultValue = index_1.UnknownWidget; }
        if (field) {
            var resolver = this.getComponentTypeResolver(field.type, defaultValue);
            return resolver(field);
        }
        return defaultValue;
    };
    return FormRenderingService;
}());
FormRenderingService = __decorate([
    core_1.Injectable(),
    __metadata("design:paramtypes", [])
], FormRenderingService);
exports.FormRenderingService = FormRenderingService;
var DefaultTypeResolver = (function () {
    function DefaultTypeResolver() {
    }
    DefaultTypeResolver.fromType = function (type) {
        return function (field) {
            return type;
        };
    };
    return DefaultTypeResolver;
}());
exports.DefaultTypeResolver = DefaultTypeResolver;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL2Zvcm0tcmVuZGVyaW5nLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7OztHQWVHOzs7Ozs7Ozs7OztBQUVILHNDQUFpRDtBQUVqRCx1REFxQnVDO0FBR3ZDLElBQWEsb0JBQW9CO0lBc0I3QjtRQXBCUSxVQUFLLEdBQTZDO1lBQ3RELE1BQU0sRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsa0JBQVUsQ0FBQztZQUNoRCxTQUFTLEVBQUUsbUJBQW1CLENBQUMsUUFBUSxDQUFDLG9CQUFZLENBQUM7WUFDckQsaUJBQWlCLEVBQUUsbUJBQW1CLENBQUMsUUFBUSxDQUFDLDJCQUFtQixDQUFDO1lBQ3BFLFNBQVMsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsc0JBQWMsQ0FBQztZQUN2RCxVQUFVLEVBQUUsbUJBQW1CLENBQUMsUUFBUSxDQUFDLHNCQUFjLENBQUM7WUFDeEQsTUFBTSxFQUFFLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxrQkFBVSxDQUFDO1lBQ2hELFFBQVEsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsb0JBQVksQ0FBQztZQUNwRCxlQUFlLEVBQUUsbUJBQW1CLENBQUMsUUFBUSxDQUFDLDBCQUFrQixDQUFDO1lBQ2pFLFdBQVcsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsdUJBQWUsQ0FBQztZQUMxRCxVQUFVLEVBQUUsbUJBQW1CLENBQUMsUUFBUSxDQUFDLDBCQUFrQixDQUFDO1lBQzVELGVBQWUsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMseUJBQWlCLENBQUM7WUFDaEUsV0FBVyxFQUFFLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyx1QkFBZSxDQUFDO1lBQzFELFFBQVEsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsb0JBQVksQ0FBQztZQUNwRCxrQkFBa0IsRUFBRSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsNkJBQXFCLENBQUM7WUFDdkUsZUFBZSxFQUFFLG1C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bmcuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE2IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEluamVjdGFibGUsIFR5cGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHtcbiAgICBGb3JtRmllbGRNb2RlbCxcbiAgICBVbmtub3duV2lkZ2V0LFxuICAgIFRleHRXaWRnZXQsXG4gICAgTXVsdGlsaW5lVGV4dFdpZGdldCxcbiAgICBOdW1iZXJXaWRnZXQsXG4gICAgQ2hlY2tib3hXaWRnZXQsXG4gICAgRHJvcGRvd25XaWRnZXQsXG4gICAgRGF0ZVdpZGdldCxcbiAgICBBbW91bnRXaWRnZXQsXG4gICAgUmFkaW9CdXR0b25zV2lkZ2V0LFxuICAgIEh5cGVybGlua1dpZGdldCxcbiAgICBEaXNwbGF5VmFsdWVXaWRnZXQsXG4gICAgRGlzcGxheVRleHRXaWRnZXQsXG4gICAgVHlwZWFoZWFkV2lkZ2V0LFxuICAgIFBlb3BsZVdpZGdldCxcbiAgICBGdW5jdGlvbmFsR3JvdXBXaWRnZXQsXG4gICAgRHluYW1pY1RhYmxlV2lkZ2V0LFxuICAgIEF0dGFjaFdpZGdldCxcbiAgICBVcGxvYWRXaWRnZXQsXG4gICAgQ29udGFpbmVyV2lkZ2V0XG59IGZyb20gJy4vLi4vY29tcG9uZW50cy93aWRnZXRzL2luZGV4JztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEZvcm1SZW5kZXJpbmdTZXJ2aWNlIHtcblxuICAgIHByaXZhdGUgdHlwZXM6IHsgW2tleTogc3RyaW5nXTogQ29tcG9uZW50VHlwZVJlc29sdmVyIH0gPSB7XG4gICAgICAgICd0ZXh0JzogRGVmYXVsdFR5cGVSZXNvbHZlci5mcm9tVHlwZShUZXh0V2lkZ2V0KSxcbiAgICAgICAgJ2ludGVnZXInOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKE51bWJlcldpZGdldCksXG4gICAgICAgICdtdWx0aS1saW5lLXRleHQnOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKE11bHRpbGluZVRleHRXaWRnZXQpLFxuICAgICAgICAnYm9vbGVhbic6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoQ2hlY2tib3hXaWRnZXQpLFxuICAgICAgICAnZHJvcGRvd24nOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKERyb3Bkb3duV2lkZ2V0KSxcbiAgICAgICAgJ2RhdGUnOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKERhdGVXaWRnZXQpLFxuICAgICAgICAnYW1vdW50JzogRGVmYXVsdFR5cGVSZXNvbHZlci5mcm9tVHlwZShBbW91bnRXaWRnZXQpLFxuICAgICAgICAncmFkaW8tYnV0dG9ucyc6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoUmFkaW9CdXR0b25zV2lkZ2V0KSxcbiAgICAgICAgJ2h5cGVybGluayc6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoSHlwZXJsaW5rV2lkZ2V0KSxcbiAgICAgICAgJ3JlYWRvbmx5JzogRGVmYXVsdFR5cGVSZXNvbHZlci5mcm9tVHlwZShEaXNwbGF5VmFsdWVXaWRnZXQpLFxuICAgICAgICAncmVhZG9ubHktdGV4dCc6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoRGlzcGxheVRleHRXaWRnZXQpLFxuICAgICAgICAndHlwZWFoZWFkJzogRGVmYXVsdFR5cGVSZXNvbHZlci5mcm9tVHlwZShUeXBlYWhlYWRXaWRnZXQpLFxuICAgICAgICAncGVvcGxlJzogRGVmYXVsdFR5cGVSZXNvbHZlci5mcm9tVHlwZShQZW9wbGVXaWRnZXQpLFxuICAgICAgICAnZnVuY3Rpb25hbC1ncm91cCc6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoRnVuY3Rpb25hbEdyb3VwV2lkZ2V0KSxcbiAgICAgICAgJ2R5bmFtaWMtdGFibGUnOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKER5bmFtaWNUYWJsZVdpZGdldCksXG4gICAgICAgICdjb250YWluZXInOiBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKENvbnRhaW5lcldpZGdldCksXG4gICAgICAgICdncm91cCc6IERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoQ29udGFpbmVyV2lkZ2V0KVxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy50eXBlc1sndXBsb2FkJ10gPSAoZmllbGQ6IEZvcm1GaWVsZE1vZGVsKTogVHlwZTx7fT4gPT4ge1xuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmFtcyA9IGZpZWxkLnBhcmFtcztcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy5saW5rKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBBdHRhY2hXaWRnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBVcGxvYWRXaWRnZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gVW5rbm93bldpZGdldDtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBnZXRDb21wb25lbnRUeXBlUmVzb2x2ZXIoZmllbGRUeXBlOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZTogVHlwZTx7fT4gPSBVbmtub3duV2lkZ2V0KTogQ29tcG9uZW50VHlwZVJlc29sdmVyIHtcbiAgICAgICAgaWYgKGZpZWxkVHlwZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHlwZXNbZmllbGRUeXBlXSB8fCBEZWZhdWx0VHlwZVJlc29sdmVyLmZyb21UeXBlKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIERlZmF1bHRUeXBlUmVzb2x2ZXIuZnJvbVR5cGUoZGVmYXVsdFZhbHVlKTtcbiAgICB9XG5cbiAgICBzZXRDb21wb25lbnRUeXBlUmVzb2x2ZXIoZmllbGRUeXBlOiBzdHJpbmcsIHJlc29sdmVyOiBDb21wb25lbnRUeXBlUmVzb2x2ZXIsIG92ZXJyaWRlOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgaWYgKCFmaWVsZFR5cGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgZmllbGRUeXBlIGlzIG51bGwgb3Igbm90IGRlZmluZWRgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghcmVzb2x2ZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgcmVzb2x2ZXIgaXMgbnVsbCBvciBub3QgZGVmaW5lZGApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGV4aXN0aW5nID0gdGhpcy50eXBlc1tmaWVsZFR5cGVdO1xuICAgICAgICBpZiAoZXhpc3RpbmcgJiYgIW92ZXJyaWRlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGFscmVhZHkgbWFwcGVkLCB1c2Ugb3ZlcnJpZGUgb3B0aW9uIGlmIHlvdSBpbnRlbmQgcmVwbGFjaW5nIGV4aXN0aW5nIG1hcHBpbmcuYCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnR5cGVzW2ZpZWxkVHlwZV0gPSByZXNvbHZlcjtcbiAgICB9XG5cbiAgICByZXNvbHZlQ29tcG9uZW50VHlwZShmaWVsZDogRm9ybUZpZWxkTW9kZWwsIGRlZmF1bHRWYWx1ZTogVHlwZTx7fT4gPSBVbmtub3duV2lkZ2V0KTogVHlwZTx7fT4ge1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIGxldCByZXNvbHZlciA9IHRoaXMuZ2V0Q29tcG9uZW50VHlwZVJlc29sdmVyKGZpZWxkLnR5cGUsIGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZXIoZmllbGQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsdWU7XG4gICAgfVxuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcG9uZW50VHlwZVJlc29sdmVyIHtcbiAgICAoZmllbGQ6IEZvcm1GaWVsZE1vZGVsKTogVHlwZTx7fT47XG59XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0VHlwZVJlc29sdmVyIHtcbiAgICBzdGF0aWMgZnJvbVR5cGUodHlwZTogVHlwZTx7fT4pOiBDb21wb25lbnRUeXBlUmVzb2x2ZXIge1xuICAgICAgICByZXR1cm4gKGZpZWxkOiBGb3JtRmllbGRNb2RlbCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgICAgIH07XG4gICAgfVxufVxuIl19
