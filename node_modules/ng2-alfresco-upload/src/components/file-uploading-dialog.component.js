/*!
 * @license
 * Copyright 2016 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var core_1 = require("@angular/core");
var ng2_alfresco_core_1 = require("ng2-alfresco-core");
var upload_service_1 = require("../services/upload.service");
var FileUploadingDialogComponent = (function () {
    function FileUploadingDialogComponent(cd, translateService, uploadService) {
        this.cd = cd;
        this.uploadService = uploadService;
        this.isDialogActive = false;
        this.totalCompleted = 0;
        this.totalCompletedMsg = 'FILE_UPLOAD.MESSAGES.SINGLE_COMPLETED';
        this._isDialogMinimized = false;
        if (translateService) {
            translateService.addTranslationFolder('ng2-alfresco-upload', 'node_modules/ng2-alfresco-upload/src');
        }
    }
    FileUploadingDialogComponent.prototype.ngOnInit = function () {
        var _this = this;
        if (this.uploadService.filesUpload$) {
            this.listSubscription = this.uploadService.filesUpload$.subscribe(function (fileList) {
                _this.filesUploadingList = fileList;
                if (_this.filesUploadingList.length > 0) {
                    _this.isDialogActive = true;
                    _this.cd.detectChanges();
                }
            });
        }
        if (this.uploadService.totalCompleted$) {
            this.counterSubscription = this.uploadService.totalCompleted$.subscribe(function (total) {
                _this.totalCompleted = total;
                if (_this.totalCompleted > 1) {
                    _this.totalCompletedMsg = 'FILE_UPLOAD.MESSAGES.COMPLETED';
                }
                _this.cd.detectChanges();
            });
        }
    };
    FileUploadingDialogComponent.prototype.toggleShowDialog = function () {
        this.isDialogActive = !this.isDialogActive;
    };
    FileUploadingDialogComponent.prototype.toggleDialogMinimize = function () {
        this._isDialogMinimized = !this._isDialogMinimized;
    };
    FileUploadingDialogComponent.prototype.ngOnDestroy = function () {
        this.listSubscription.unsubscribe();
        this.counterSubscription.unsubscribe();
        this.cd.detach();
    };
    return FileUploadingDialogComponent;
}());
FileUploadingDialogComponent = __decorate([
    core_1.Component({
        selector: 'file-uploading-dialog',
        moduleId: module.id,
        template: "<div class=\"file-dialog\" [ngClass]=\"{show: isDialogActive}\">     <div class=\"header\">         <div class=\"title\">             <span id=\"total-upload-completed\">{{totalCompleted}}</span> {{ totalCompletedMsg | translate}}         </div>         <div class=\"buttons\">             <div class=\"minimize-button\" [ngClass]=\"{active: _isDialogMinimized}\" (keyup.enter)=\"toggleDialogMinimize()\" (click)=\"toggleDialogMinimize()\" tabindex=\"0\">                 <i class=\"material-icons down\" title=\"minimize upload list\">keyboard_arrow_down</i>                 <i class=\"material-icons up\" title=\"expand upload list\">keyboard_arrow_up</i>             </div>              <div class=\"close-button\" (click)=\"toggleShowDialog()\" (keyup.enter)=\"toggleShowDialog()\" tabindex=\"0\" title=\"close upload list\">                 <i class=\"material-icons\">clear</i>             </div>         </div>     </div>     <div class=\"body-dialog\" *ngIf=\"filesUploadingList\"  [ngClass]=\"{hide: _isDialogMinimized}\">         <alfresco-file-uploading-list [filesUploadingList]=\"filesUploadingList\"></alfresco-file-uploading-list>     </div> </div>",
        styles: [":host{     position: fixed;     bottom: 0;     width: 100%;     z-index: 1; }  :host .show {     display: block !important; }  :host .hide {     display: none !important; }  :host .file-dialog {     width: 700px;     display: none;     -webkit-box-shadow: 0 2px 8px 0 rgba(0, 0, 0, .2);     box-shadow: -2px -1px 8px 3px rgba(0, 0, 0, .2);     -webkit-border-radius: 2px;     border-radius: 2px;     -webkit-transform: translate3d(0, 0, 0);     transform: translate3d(0, 0, 0);     -webkit-transition-delay: 0s;     transition-delay: 0s;     opacity: 1;     -webkit-transition: transform .15s cubic-bezier(0.4, 0.0, 1, 1), opacity .15s cubic-bezier(0.4, 0.0, 1, 1), visibility 0ms linear .15s;     transition: transform .15s cubic-bezier(0.4, 0.0, 1, 1), opacity .15s cubic-bezier(0.4, 0.0, 1, 1), visibility 0ms linear .15s;     bottom: 0px;     left: auto;     max-height: 350px;     overflow: visible;     right: 24px;     position: fixed; }  :host .file-dialog .header {     background-color: rgb(31, 188, 210);     border: 1px transparent solid;     border-bottom: 1px solid #c7c7c7;     -moz-border-radius-topleft: 2px;     -webkit-border-top-left-radius: 2px;     border-top-left-radius: 2px;     -moz-border-radius-topright: 2px;     -webkit-border-top-right-radius: 2px;     border-top-right-radius: 2px;     bottom: 0px;     color: white;     font-size: 14px;     height: 52px;     line-height: 52px;     padding: 0px 10px 0px 10px; }  :host .file-dialog .header .title {     float: left;     min-width: 150px;     color: white; }  :host .file-dialog .header .buttons {     float: right;     padding: 10px 10px 10px 10px;     text-align: center;     color: white;     font-size: 14px;     opacity: 0.5; }  :host .file-dialog .header .close-button {     cursor: pointer;     float: left;     height: 35px;     width: 35px;     -webkit-border-radius: 2px;     -moz-border-radius: 2px;     border-radius: 2px;     border: 1px solid transparent; }  :host .file-dialog .header .close-button:hover {     border: 1px solid white;     opacity: 1.0; }  .minimize-button {     display: flex;     align-items: center;     justify-content: center; }  :host .file-dialog .header .minimize-button {     cursor: pointer;     float: left;     height: 35px;     width: 35px;     margin-right: 10px;     -webkit-border-radius: 2px;     -moz-border-radius: 2px;     border-radius: 2px;     border: 1px solid transparent; }  .up {     display: none; }  .down {     display: block; }  .active .up {     display: block; }  .active .down {     display: none; }  .file-dialog .header .minimize-button:hover {     border: 1px solid white;     opacity: 1.0; }  :host .file-dialog .body-dialog {     float: left;     height: 100%;     margin-top: -4px;     border-bottom: 1px solid #C0C0C0;     border-right: 1px solid #C0C0C0;     border-left: 1px solid #C0C0C0;     max-height: 200px;     overflow-y: auto;     width: 99.6%; }  :host .mdl-data-table th {     text-align: left; }  @media (max-width: 720px) {     :host .file-dialog {         width: 100%;         right: 0;     } }"],
        host: { '[class.dialog-show]': 'toggleShowDialog' }
    }),
    __metadata("design:paramtypes", [core_1.ChangeDetectorRef,
        ng2_alfresco_core_1.AlfrescoTranslationService,
        upload_service_1.UploadService])
], FileUploadingDialogComponent);
exports.FileUploadingDialogComponent = FileUploadingDialogComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvZmlsZS11cGxvYWRpbmctZGlhbG9nLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7O0dBZUc7Ozs7Ozs7Ozs7O0FBRUgsc0NBQWdGO0FBRWhGLHVEQUErRDtBQUMvRCw2REFBMkQ7QUFvQjNELElBQWEsNEJBQTRCO0lBZXJDLHNDQUFvQixFQUFxQixFQUM3QixnQkFBNEMsRUFDcEMsYUFBNEI7UUFGNUIsT0FBRSxHQUFGLEVBQUUsQ0FBbUI7UUFFckIsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFmaEQsbUJBQWMsR0FBWSxLQUFLLENBQUM7UUFJaEMsbUJBQWMsR0FBVyxDQUFDLENBQUM7UUFFM0Isc0JBQWlCLEdBQVcsdUNBQXVDLENBQUM7UUFFNUQsdUJBQWtCLEdBQVksS0FBSyxDQUFDO1FBUXhDLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUNuQixnQkFBZ0IsQ0FBQyxvQkFBb0IsQ0FBQyxxQkFBcUIsRUFBRSxzQ0FBc0MsQ0FBQyxDQUFDO1FBQ3pHLENBQUM7SUFDTCxDQUFDO0lBRUQsK0NBQVEsR0FBUjtRQUFBLGlCQW1CQztRQWxCRyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFDbEMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxVQUFDLFFBQXFCO2dCQUNwRixLQUFJLENBQUMsa0JBQWtCLEdBQUcsUUFBUSxDQUFDO2dCQUNuQyxFQUFFLENBQUMsQ0FBQyxLQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ3JDLEtBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO29CQUMzQixLQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxDQUFDO2dCQUM1QixDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDO1FBQ0QsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUMsVUFBQyxLQUFhO2dCQUNsRixLQUFJLENBQUMsY0FBYyxHQUFHLEtBQUssQ0FBQztnQkFDNUIsRUFBRSxDQUFDLENBQUMsS0FBSSxDQUFDLGNBQWMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMxQixLQUFJLENBQUMsaUJBQWlCLEdBQUcsZ0NBQWdDLENBQUM7Z0JBQzlELENBQUM7Z0JBQ0QsS0FBSSxDQUFDLEVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztZQUM1QixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUM7SUFDTCxDQUFDO0lBS0QsdURBQWdCLEdBQWhCO1FBQ0ksSUFBSSxDQUFDLGNBQWMsR0FBRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDL0MsQ0FBQztJQUtELDJEQUFvQixHQUFwQjtRQUNJLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztJQUN2RCxDQUFDO0lBRUQsa0RBQVcsR0FBWDtRQUNJLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNwQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDdkMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNyQixDQUFDO0lBQ0wsbUNBQUM7QUFBRCxDQS9EQSxBQStEQyxJQUFBO0FBL0RZLDRCQUE0QjtJQVB4QyxnQkFBUyxDQUFDO1FBQ1AsUUFBUSxFQUFFLHVCQUF1QjtRQUNqQyxRQUFRLEVBQUUsTUFBTSxDQUFDLEVBQUU7UUFDbkIsUUFBUSxFQUFFLDZvQ0FBNm9DO1FBQ3ZwQyxNQUFNLEVBQUUsQ0FBQywwL0ZBQTAvRixDQUFDO1FBQ3BnRyxJQUFJLEVBQUUsRUFBQyxxQkFBcUIsRUFBRSxrQkFBa0IsRUFBQztLQUNwRCxDQUFDO3FDQWdCMEIsd0JBQWlCO1FBQ1gsOENBQTBCO1FBQ3JCLDhCQUFhO0dBakJ2Qyw0QkFBNEIsQ0ErRHhDO0FBL0RZLG9FQUE0QiIsImZpbGUiOiJjb21wb25lbnRzL2ZpbGUtdXBsb2FkaW5nLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNiBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBDb21wb25lbnQsIENoYW5nZURldGVjdG9yUmVmLCBPbkluaXQsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRmlsZU1vZGVsIH0gZnJvbSAnLi4vbW9kZWxzL2ZpbGUubW9kZWwnO1xuaW1wb3J0IHsgQWxmcmVzY29UcmFuc2xhdGlvblNlcnZpY2UgfSBmcm9tICduZzItYWxmcmVzY28tY29yZSc7XG5pbXBvcnQgeyBVcGxvYWRTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdXBsb2FkLnNlcnZpY2UnO1xuXG4vKipcbiAqIDxmaWxlLXVwbG9hZGluZy1kaWFsb2cgW2ZpbGVzVXBsb2FkaW5nTGlzdF09XCJGaWxlTW9kZWxbXVwiID48L2ZpbGUtdXBsb2FkaW5nLWRpYWxvZz5cbiAqXG4gKiBUaGlzIGNvbXBvbmVudCBpcyBhIGhpZGVhYmxlIGFuZCBtaW5pbWl6YWJsZSB3aWNoIGNvbnRhaW5zIHRoZSBsaXN0IG9mIHRoZSB1cGxvYWRpbmdcbiAqIGZpbGVzIGNvbnRhaW5lZCBpbiB0aGUgZmlsZXNVcGxvYWRpbmdMaXN0LlxuICpcbiAqIEBJbnB1dFBhcmFtIHtGaWxlTW9kZWxbXX0gZmlsZXNVcGxvYWRpbmdMaXN0IC0gbGlzdCBvZiB0aGUgdXBsb2FkaW5nIGZpbGVzIC5cbiAqXG4gKlxuICogQHJldHVybnMge0ZpbGVVcGxvYWRpbmdEaWFsb2dDb21wb25lbnR9IC5cbiAqL1xuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdmaWxlLXVwbG9hZGluZy1kaWFsb2cnLFxuICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gICAgdGVtcGxhdGU6IFwiPGRpdiBjbGFzcz1cXFwiZmlsZS1kaWFsb2dcXFwiIFtuZ0NsYXNzXT1cXFwie3Nob3c6IGlzRGlhbG9nQWN0aXZlfVxcXCI+ICAgICA8ZGl2IGNsYXNzPVxcXCJoZWFkZXJcXFwiPiAgICAgICAgIDxkaXYgY2xhc3M9XFxcInRpdGxlXFxcIj4gICAgICAgICAgICAgPHNwYW4gaWQ9XFxcInRvdGFsLXVwbG9hZC1jb21wbGV0ZWRcXFwiPnt7dG90YWxDb21wbGV0ZWR9fTwvc3Bhbj4ge3sgdG90YWxDb21wbGV0ZWRNc2cgfCB0cmFuc2xhdGV9fSAgICAgICAgIDwvZGl2PiAgICAgICAgIDxkaXYgY2xhc3M9XFxcImJ1dHRvbnNcXFwiPiAgICAgICAgICAgICA8ZGl2IGNsYXNzPVxcXCJtaW5pbWl6ZS1idXR0b25cXFwiIFtuZ0NsYXNzXT1cXFwie2FjdGl2ZTogX2lzRGlhbG9nTWluaW1pemVkfVxcXCIgKGtleXVwLmVudGVyKT1cXFwidG9nZ2xlRGlhbG9nTWluaW1pemUoKVxcXCIgKGNsaWNrKT1cXFwidG9nZ2xlRGlhbG9nTWluaW1pemUoKVxcXCIgdGFiaW5kZXg9XFxcIjBcXFwiPiAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XFxcIm1hdGVyaWFsLWljb25zIGRvd25cXFwiIHRpdGxlPVxcXCJtaW5pbWl6ZSB1cGxvYWQgbGlzdFxcXCI+a2V5Ym9hcmRfYXJyb3dfZG93bjwvaT4gICAgICAgICAgICAgICAgIDxpIGNsYXNzPVxcXCJtYXRlcmlhbC1pY29ucyB1cFxcXCIgdGl0bGU9XFxcImV4cGFuZCB1cGxvYWQgbGlzdFxcXCI+a2V5Ym9hcmRfYXJyb3dfdXA8L2k+ICAgICAgICAgICAgIDwvZGl2PiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cXFwiY2xvc2UtYnV0dG9uXFxcIiAoY2xpY2spPVxcXCJ0b2dnbGVTaG93RGlhbG9nKClcXFwiIChrZXl1cC5lbnRlcik9XFxcInRvZ2dsZVNob3dEaWFsb2coKVxcXCIgdGFiaW5kZXg9XFxcIjBcXFwiIHRpdGxlPVxcXCJjbG9zZSB1cGxvYWQgbGlzdFxcXCI+ICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cXFwibWF0ZXJpYWwtaWNvbnNcXFwiPmNsZWFyPC9pPiAgICAgICAgICAgICA8L2Rpdj4gICAgICAgICA8L2Rpdj4gICAgIDwvZGl2PiAgICAgPGRpdiBjbGFzcz1cXFwiYm9keS1kaWFsb2dcXFwiICpuZ0lmPVxcXCJmaWxlc1VwbG9hZGluZ0xpc3RcXFwiICBbbmdDbGFzc109XFxcIntoaWRlOiBfaXNEaWFsb2dNaW5pbWl6ZWR9XFxcIj4gICAgICAgICA8YWxmcmVzY28tZmlsZS11cGxvYWRpbmctbGlzdCBbZmlsZXNVcGxvYWRpbmdMaXN0XT1cXFwiZmlsZXNVcGxvYWRpbmdMaXN0XFxcIj48L2FsZnJlc2NvLWZpbGUtdXBsb2FkaW5nLWxpc3Q+ICAgICA8L2Rpdj4gPC9kaXY+XCIsXG4gICAgc3R5bGVzOiBbXCI6aG9zdHsgICAgIHBvc2l0aW9uOiBmaXhlZDsgICAgIGJvdHRvbTogMDsgICAgIHdpZHRoOiAxMDAlOyAgICAgei1pbmRleDogMTsgfSAgOmhvc3QgLnNob3cgeyAgICAgZGlzcGxheTogYmxvY2sgIWltcG9ydGFudDsgfSAgOmhvc3QgLmhpZGUgeyAgICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9ICA6aG9zdCAuZmlsZS1kaWFsb2cgeyAgICAgd2lkdGg6IDcwMHB4OyAgICAgZGlzcGxheTogbm9uZTsgICAgIC13ZWJraXQtYm94LXNoYWRvdzogMCAycHggOHB4IDAgcmdiYSgwLCAwLCAwLCAuMik7ICAgICBib3gtc2hhZG93OiAtMnB4IC0xcHggOHB4IDNweCByZ2JhKDAsIDAsIDAsIC4yKTsgICAgIC13ZWJraXQtYm9yZGVyLXJhZGl1czogMnB4OyAgICAgYm9yZGVyLXJhZGl1czogMnB4OyAgICAgLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZTNkKDAsIDAsIDApOyAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUzZCgwLCAwLCAwKTsgICAgIC13ZWJraXQtdHJhbnNpdGlvbi1kZWxheTogMHM7ICAgICB0cmFuc2l0aW9uLWRlbGF5OiAwczsgICAgIG9wYWNpdHk6IDE7ICAgICAtd2Via2l0LXRyYW5zaXRpb246IHRyYW5zZm9ybSAuMTVzIGN1YmljLWJlemllcigwLjQsIDAuMCwgMSwgMSksIG9wYWNpdHkgLjE1cyBjdWJpYy1iZXppZXIoMC40LCAwLjAsIDEsIDEpLCB2aXNpYmlsaXR5IDBtcyBsaW5lYXIgLjE1czsgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAuMTVzIGN1YmljLWJlemllcigwLjQsIDAuMCwgMSwgMSksIG9wYWNpdHkgLjE1cyBjdWJpYy1iZXppZXIoMC40LCAwLjAsIDEsIDEpLCB2aXNpYmlsaXR5IDBtcyBsaW5lYXIgLjE1czsgICAgIGJvdHRvbTogMHB4OyAgICAgbGVmdDogYXV0bzsgICAgIG1heC1oZWlnaHQ6IDM1MHB4OyAgICAgb3ZlcmZsb3c6IHZpc2libGU7ICAgICByaWdodDogMjRweDsgICAgIHBvc2l0aW9uOiBmaXhlZDsgfSAgOmhvc3QgLmZpbGUtZGlhbG9nIC5oZWFkZXIgeyAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDMxLCAxODgsIDIxMCk7ICAgICBib3JkZXI6IDFweCB0cmFuc3BhcmVudCBzb2xpZDsgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjYzdjN2M3OyAgICAgLW1vei1ib3JkZXItcmFkaXVzLXRvcGxlZnQ6IDJweDsgICAgIC13ZWJraXQtYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMnB4OyAgICAgYm9yZGVyLXRvcC1sZWZ0LXJhZGl1czogMnB4OyAgICAgLW1vei1ib3JkZXItcmFkaXVzLXRvcHJpZ2h0OiAycHg7ICAgICAtd2Via2l0LWJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiAycHg7ICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMnB4OyAgICAgYm90dG9tOiAwcHg7ICAgICBjb2xvcjogd2hpdGU7ICAgICBmb250LXNpemU6IDE0cHg7ICAgICBoZWlnaHQ6IDUycHg7ICAgICBsaW5lLWhlaWdodDogNTJweDsgICAgIHBhZGRpbmc6IDBweCAxMHB4IDBweCAxMHB4OyB9ICA6aG9zdCAuZmlsZS1kaWFsb2cgLmhlYWRlciAudGl0bGUgeyAgICAgZmxvYXQ6IGxlZnQ7ICAgICBtaW4td2lkdGg6IDE1MHB4OyAgICAgY29sb3I6IHdoaXRlOyB9ICA6aG9zdCAuZmlsZS1kaWFsb2cgLmhlYWRlciAuYnV0dG9ucyB7ICAgICBmbG9hdDogcmlnaHQ7ICAgICBwYWRkaW5nOiAxMHB4IDEwcHggMTBweCAxMHB4OyAgICAgdGV4dC1hbGlnbjogY2VudGVyOyAgICAgY29sb3I6IHdoaXRlOyAgICAgZm9udC1zaXplOiAxNHB4OyAgICAgb3BhY2l0eTogMC41OyB9ICA6aG9zdCAuZmlsZS1kaWFsb2cgLmhlYWRlciAuY2xvc2UtYnV0dG9uIHsgICAgIGN1cnNvcjogcG9pbnRlcjsgICAgIGZsb2F0OiBsZWZ0OyAgICAgaGVpZ2h0OiAzNXB4OyAgICAgd2lkdGg6IDM1cHg7ICAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDJweDsgICAgIC1tb3otYm9yZGVyLXJhZGl1czogMnB4OyAgICAgYm9yZGVyLXJhZGl1czogMnB4OyAgICAgYm9yZGVyOiAxcHggc29saWQgdHJhbnNwYXJlbnQ7IH0gIDpob3N0IC5maWxlLWRpYWxvZyAuaGVhZGVyIC5jbG9zZS1idXR0b246aG92ZXIgeyAgICAgYm9yZGVyOiAxcHggc29saWQgd2hpdGU7ICAgICBvcGFjaXR5OiAxLjA7IH0gIC5taW5pbWl6ZS1idXR0b24geyAgICAgZGlzcGxheTogZmxleDsgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7ICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgfSAgOmhvc3QgLmZpbGUtZGlhbG9nIC5oZWFkZXIgLm1pbmltaXplLWJ1dHRvbiB7ICAgICBjdXJzb3I6IHBvaW50ZXI7ICAgICBmbG9hdDogbGVmdDsgICAgIGhlaWdodDogMzVweDsgICAgIHdpZHRoOiAzNXB4OyAgICAgbWFyZ2luLXJpZ2h0OiAxMHB4OyAgICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAycHg7ICAgICAtbW96LWJvcmRlci1yYWRpdXM6IDJweDsgICAgIGJvcmRlci1yYWRpdXM6IDJweDsgICAgIGJvcmRlcjogMXB4IHNvbGlkIHRyYW5zcGFyZW50OyB9ICAudXAgeyAgICAgZGlzcGxheTogbm9uZTsgfSAgLmRvd24geyAgICAgZGlzcGxheTogYmxvY2s7IH0gIC5hY3RpdmUgLnVwIHsgICAgIGRpc3BsYXk6IGJsb2NrOyB9ICAuYWN0aXZlIC5kb3duIHsgICAgIGRpc3BsYXk6IG5vbmU7IH0gIC5maWxlLWRpYWxvZyAuaGVhZGVyIC5taW5pbWl6ZS1idXR0b246aG92ZXIgeyAgICAgYm9yZGVyOiAxcHggc29saWQgd2hpdGU7ICAgICBvcGFjaXR5OiAxLjA7IH0gIDpob3N0IC5maWxlLWRpYWxvZyAuYm9keS1kaWFsb2cgeyAgICAgZmxvYXQ6IGxlZnQ7ICAgICBoZWlnaHQ6IDEwMCU7ICAgICBtYXJnaW4tdG9wOiAtNHB4OyAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNDMEMwQzA7ICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjQzBDMEMwOyAgICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCAjQzBDMEMwOyAgICAgbWF4LWhlaWdodDogMjAwcHg7ICAgICBvdmVyZmxvdy15OiBhdXRvOyAgICAgd2lkdGg6IDk5LjYlOyB9ICA6aG9zdCAubWRsLWRhdGEtdGFibGUgdGggeyAgICAgdGV4dC1hbGlnbjogbGVmdDsgfSAgQG1lZGlhIChtYXgtd2lkdGg6IDcyMHB4KSB7ICAgICA6aG9zdCAuZmlsZS1kaWFsb2cgeyAgICAgICAgIHdpZHRoOiAxMDAlOyAgICAgICAgIHJpZ2h0OiAwOyAgICAgfSB9XCJdLFxuICAgIGhvc3Q6IHsnW2NsYXNzLmRpYWxvZy1zaG93XSc6ICd0b2dnbGVTaG93RGlhbG9nJ31cbn0pXG5leHBvcnQgY2xhc3MgRmlsZVVwbG9hZGluZ0RpYWxvZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcblxuICAgIGlzRGlhbG9nQWN0aXZlOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBmaWxlc1VwbG9hZGluZ0xpc3Q6IEZpbGVNb2RlbCBbXTtcblxuICAgIHRvdGFsQ29tcGxldGVkOiBudW1iZXIgPSAwO1xuXG4gICAgdG90YWxDb21wbGV0ZWRNc2c6IHN0cmluZyA9ICdGSUxFX1VQTE9BRC5NRVNTQUdFUy5TSU5HTEVfQ09NUExFVEVEJztcblxuICAgIHByaXZhdGUgX2lzRGlhbG9nTWluaW1pemVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIGxpc3RTdWJzY3JpcHRpb246IGFueTtcbiAgICBwcml2YXRlIGNvdW50ZXJTdWJzY3JpcHRpb246IGFueTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxuICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVNlcnZpY2U6IEFsZnJlc2NvVHJhbnNsYXRpb25TZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgdXBsb2FkU2VydmljZTogVXBsb2FkU2VydmljZSkge1xuICAgICAgICBpZiAodHJhbnNsYXRlU2VydmljZSkge1xuICAgICAgICAgICAgdHJhbnNsYXRlU2VydmljZS5hZGRUcmFuc2xhdGlvbkZvbGRlcignbmcyLWFsZnJlc2NvLXVwbG9hZCcsICdub2RlX21vZHVsZXMvbmcyLWFsZnJlc2NvLXVwbG9hZC9zcmMnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICBpZiAodGhpcy51cGxvYWRTZXJ2aWNlLmZpbGVzVXBsb2FkJCkge1xuICAgICAgICAgICAgdGhpcy5saXN0U3Vic2NyaXB0aW9uID0gdGhpcy51cGxvYWRTZXJ2aWNlLmZpbGVzVXBsb2FkJC5zdWJzY3JpYmUoKGZpbGVMaXN0OiBGaWxlTW9kZWxbXSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNVcGxvYWRpbmdMaXN0ID0gZmlsZUxpc3Q7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmlsZXNVcGxvYWRpbmdMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RpYWxvZ0FjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2QuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnVwbG9hZFNlcnZpY2UudG90YWxDb21wbGV0ZWQkKSB7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXJTdWJzY3JpcHRpb24gPSB0aGlzLnVwbG9hZFNlcnZpY2UudG90YWxDb21wbGV0ZWQkLnN1YnNjcmliZSgodG90YWw6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudG90YWxDb21wbGV0ZWQgPSB0b3RhbDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b3RhbENvbXBsZXRlZCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbENvbXBsZXRlZE1zZyA9ICdGSUxFX1VQTE9BRC5NRVNTQUdFUy5DT01QTEVURUQnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNkLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcGxheSBhbmQgaGlkZSB0aGUgZGlhbG9nIGNvbXBvbmVudC5cbiAgICAgKi9cbiAgICB0b2dnbGVTaG93RGlhbG9nKCkge1xuICAgICAgICB0aGlzLmlzRGlhbG9nQWN0aXZlID0gIXRoaXMuaXNEaWFsb2dBY3RpdmU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTWluaW1pemUgYW5kIGV4cGFuZCB0aGUgZGlhbG9nIGNvbXBvbmVudC5cbiAgICAgKi9cbiAgICB0b2dnbGVEaWFsb2dNaW5pbWl6ZSgpIHtcbiAgICAgICAgdGhpcy5faXNEaWFsb2dNaW5pbWl6ZWQgPSAhdGhpcy5faXNEaWFsb2dNaW5pbWl6ZWQ7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMubGlzdFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmNvdW50ZXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jZC5kZXRhY2goKTtcbiAgICB9XG59XG4iXX0=
